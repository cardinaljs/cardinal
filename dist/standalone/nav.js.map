{"version":3,"file":"nav.js","sources":["../../src/nav/backdrop.js","../../src/nav/drawer.js","../../src/nav/navservice.js","../../src/nav/popservice.js","../../src/nav/state.js","../../src/nav/index.js"],"sourcesContent":["import {\n  css\n} from '../util'\n\nexport class Backdrop {\n  constructor(backdrop) {\n    this.backdrop = backdrop\n  }\n\n  show(time) {\n    css(this.backdrop, {\n      display: 'block',\n      opacity: 1,\n      transition: `opacity linear ${time / 1e3}s`\n    })\n  }\n\n  hide(time) {\n    css(this.backdrop, {\n      opacity: 0,\n      transition: `opacity linear ${time / 1e3}s`\n    })\n    window.setTimeout(() => {\n      css(this.backdrop, {\n        display: 'none'\n      })\n    }, time)\n  }\n\n  setOpacity(val) {\n    css(this.backdrop, {\n      display: 'block',\n      opacity: val,\n      transition: 'none'\n    })\n  }\n}\n","import {\n  Bound,\n  DIRECTIONS,\n  NAVSTATE_EVENTS,\n  NAV_BOX_SHADOW,\n  WINDOW,\n  css,\n  getAttribute,\n  getData\n} from './../util'\nimport Drawer from './../drawer/'\n\nconst ZERO = 0\nconst KILO = 1e3\nconst MIN_TIME_TO_OVERRIDE_BELOWTHRESHOLD = 0.5\nconst MIN_POSITIVE_DISPLACEMENT = 10\nconst MIN_NEGATIVE_DISPLACEMENT = -MIN_POSITIVE_DISPLACEMENT\nconst TRANSITION_STYLE = 'linear'// 'cubic-bezier(0, 0.5, 0, 1)'\nconst EFFECT = 'transition'\nconst OVERFLOW = 'overflow'\nconst TRANS_TIMING = '0.1s'\nconst TRANS_TEMPLATE = `${TRANSITION_STYLE} ${TRANS_TIMING}`\nconst HIDDEN = 'hidden'\nconst SCROLL = 'scroll'\nconst AUTO = 'auto'\nconst HREF = 'href'\nconst HASH_ATTR = `data-${HREF}`\nconst START = 'start'\nconst MOVE = 'move'\nconst THRESHOLD = 'threshold'\nconst BELOW_THRESHOLD = `below${THRESHOLD}`\nconst MIN_SPEED = 100\nconst MAX_SPEED = 500\n\nclass NavDrawer {\n  /**\n   * Creates a new NavDrawer object. Providing the Left and Right\n   * Drawer functionality.\n   * Support for Top and Bottom may come in the future\n   * @throws RangeError\n   * @param {{}} options An options Object to configure the Drawer with\n   * @param {{}} state An activity and service manager\n   */\n  constructor(options, state) {\n    this.options = options\n    this.state = state\n    this.element = this.options.ELEMENT\n    this._body = this.options.BODY\n    this._backdrop = this.options.BACKDROP\n    this.direction = this.options.DIRECTION\n\n    this._checkDirection()\n\n    this.directionString = DIRECTIONS[this.direction]\n    this.bound = this._bound\n\n    const o = {\n      ...options,\n      SIZE: this.elementSize,\n      TARGET: document\n    }\n    this.drawer = new Drawer.SnappedDrawer(o, this.bound, Drawer.DrawerManagementStore)\n    Drawer.DrawerManagementStore.pushActivity(this.state.activity)\n    this.transition = `${this.directionString} ${TRANS_TEMPLATE}`\n  }\n\n  activate() {\n    this.drawer.on(START, this._startHandler)\n      .on(MOVE, this._moveHandler)\n      .on(THRESHOLD, this._threshold)\n      .on(BELOW_THRESHOLD, this._belowThreshold)\n      .setContext(this)\n      .activate()\n    this.drawer.setServiceID(this.state.activity.id)\n    return 0\n  }\n\n  deactivate() {\n    this.drawer.deactivate()\n    return 0\n  }\n\n  get elementSize() {\n    const axis = this.direction\n    if (axis === Drawer.UP || axis === Drawer.DOWN) {\n      return this.element.offsetHeight\n    }\n    return this.element.offsetWidth\n  }\n\n  /**\n   * @returns {Bound} a boundary object: Bound\n   */\n  get _bound() {\n    const upperBound = this.elementSize\n    if (this.direction === Drawer.RIGHT) {\n      const lowerBound = WINDOW.screen.width - this.element.offsetLeft\n      return new Bound(lowerBound, upperBound)\n    }\n    const lowerBound = upperBound + this.element.offsetLeft\n    return new Bound(lowerBound, upperBound)\n  }\n\n  _startHandler(service, response) {\n    service.lock()\n    this.state.activity.run()\n    css(this.element, {\n      [this.directionString]: response.dimension,\n      boxShadow: NAV_BOX_SHADOW[this.directionString],\n      [EFFECT]: this.transition\n    })\n    this._body.style.overflow = HIDDEN\n  }\n\n  _moveHandler(service, response, rectangle) {\n    service.lock()\n    let curPos = this.direction === Drawer.UP || this.direction === Drawer.DOWN ? rectangle.coordsY.y2 : rectangle.coordsX.x2\n    css(this.element, {\n      [this.directionString]: response.dimension,\n      [EFFECT]: 'none',\n      [OVERFLOW]: HIDDEN\n    })\n    if (this.direction === Drawer.RIGHT) {\n      const WIN_SIZE = WINDOW.screen.width\n      curPos = WIN_SIZE - curPos\n      this._backdrop.setOpacity(curPos / this.elementSize)\n      return\n    }\n    this._backdrop.setOpacity(curPos / this.elementSize)\n  }\n\n  _threshold(service, state, stateObj, rect) {\n    service.lock()\n    const isOpen = state[1] === 'open'\n    const options = {\n      stateObj,\n      transition: `${this.directionString} ${TRANSITION_STYLE} ${this._calcSpeed(stateObj.TIMING, rect.width) / KILO}s`\n    }\n    if (isOpen) {\n      this._hide(options)\n    } else {\n      this._show(options)\n    }\n  }\n\n  _belowThreshold(service, state, stateObj, rect) {\n    service.lock()\n    const isClosed = state[1] !== 'open'\n    const overallEventTime = stateObj.TIMING\n    const MTTOB = MIN_TIME_TO_OVERRIDE_BELOWTHRESHOLD\n    const MPD = MIN_POSITIVE_DISPLACEMENT\n    const MND = MIN_NEGATIVE_DISPLACEMENT\n    const displacement = this.direction === Drawer.UP || this.direction === Drawer.DOWN\n      ? rect.displacementY : rect.displacementX\n    const options = {\n      stateObj,\n      transition: `${this.directionString} ${TRANSITION_STYLE} ${this._calcSpeed(stateObj.TIMING, rect.width) / KILO}s`\n    }\n    let LOGIC\n    if (this.direction === Drawer.LEFT && isClosed || this.direction === Drawer.RIGHT && !isClosed) {\n      LOGIC =  displacement > ZERO && displacement >= MPD && rect.greaterWidth\n    } else {\n      LOGIC = displacement < ZERO && displacement <= MND && rect.greaterWidth\n    }\n\n    if (overallEventTime / KILO < MTTOB) {\n      if (LOGIC) {\n        this._overrideBelowThresh(!isClosed, options)\n      } else {\n        if (isClosed) {\n          // Close it. Can't override\n          this._hide(options)\n          return\n        }\n        // Open it. Can't override. Not enough displacement\n        this._show(options)\n      }\n    } else {\n      if (isClosed) {\n        // close it\n        this._hide(options)\n        return\n      }\n      // open it\n      this._show(options)\n    }\n  }\n\n  _show(options) {\n    this._showPrep(options)\n    this.element.style[this.directionString] = options.stateObj.dimension\n  }\n\n  _hide(options) {\n    this._hidePrep(options)\n    this.element.style[this.directionString] = options.stateObj.dimension\n  }\n\n  _overrideBelowThresh(isOpen, options) {\n    if (isOpen) {\n      this._hidePrep(options)\n      this.element.style[this.directionString] = options.stateObj.oppositeDimension\n    } else {\n      this._showPrep(options)\n      this.element.style[this.directionString] = options.stateObj.oppositeDimension\n    }\n  }\n\n  _hidePrep(options) {\n    this.state.activity.derun()\n    this._body.style.overflow = SCROLL\n    this._backdrop.hide(this.options.TRANSITION)\n    css(this.element, {\n      [EFFECT]: options.transition,\n      [OVERFLOW]: AUTO\n    })\n    if (!this.bound.lower) {\n      this.element.style.boxShadow = 'none'\n    }\n    this._setState('close')\n    // callback for when nav is hidden\n    if (this.state.isRegisteredEvent(NAVSTATE_EVENTS.hide)) {\n      this.state.getStateEventHandler(NAVSTATE_EVENTS.hide)()\n    }\n  }\n\n  _showPrep(options) {\n    const buttonHash = getAttribute(this.options.INIT_ELEM, HREF) || getData(this.options.INIT_ELEM, HASH_ATTR)\n    if (buttonHash) {\n      WINDOW.location.hash = buttonHash\n    }\n    this._body.style.overflow = HIDDEN\n    this._backdrop.show(this.options.TRANSITION)\n    css(this.element, {\n      [EFFECT]: options.transition,\n      [OVERFLOW]: AUTO\n    })\n    this._setState('open')\n    // callback for when nav is shown\n    if (this.state.isRegisteredEvent(NAVSTATE_EVENTS.show)) {\n      this.state.getStateEventHandler(NAVSTATE_EVENTS.show)()\n    }\n  }\n\n  _calcSpeed(time, distance) {\n    const distanceRemain = this.elementSize - distance\n    if (~Math.sign(distanceRemain)) {\n      let newTime = distanceRemain * time / distance\n      if (newTime > MAX_SPEED) {\n        newTime = MAX_SPEED\n      } else if (newTime < MIN_SPEED) {\n        newTime = MIN_SPEED\n      }\n      return newTime\n    }\n    return 0\n  }\n\n  _checkDirection() {\n    if (this.direction !== Drawer.LEFT && this.direction !== Drawer.RIGHT) {\n      throw new RangeError('Direction out of range')\n    }\n  }\n\n  _setState(mode) {\n    switch (mode) {\n      case 'open':\n        this.state.activity.run()\n        break\n      case 'close':\n        this.state.activity.derun()\n        break\n      default:\n        throw new Error('this should never happen')\n    }\n  }\n}\n\nexport default NavDrawer\n","import {\n  NAVSTATE_EVENTS,\n  NAV_BOX_SHADOW,\n  WINDOW,\n  ZERO,\n  css,\n  getAttribute,\n  getData\n} from './../util'\n\nconst TRANSITION_STYLE = 'cubic-bezier(0, 0.5, 0, 1)'\nconst EFFECT = 'transition'\nconst TRANS_END = 'transitionend'\n\nclass NavService {\n  constructor(options, state) {\n    this.options = options\n    this.state = state\n    this.nav = options.ELEMENT\n    this.button = options.INIT_ELEM\n    this.body = options.BODY\n    this.backdrop = options.BACKDROP\n    this.backdropElement = this.backdrop.backdrop\n    this.event = 'click'\n    this.direction = options.DIRECTION\n    this.width = this.nav.offsetWidth\n    this.transTime = options.TRANSITION / 1e3\n    this.transition = `${this.direction} ${TRANSITION_STYLE} ${this.transTime}s`\n    // state of the nav, whether open or close\n    this.alive = false\n    // diff. btw. event triggered from Drawer class and on here\n    /**\n     * @private\n     */\n    this._closeInvoked = false\n    /**\n     * @readonly\n     * @private\n     */\n    this._initialState = NavService.css(this.nav, this.direction)\n    this._handlers = null\n  }\n\n  activate() {\n    const ClickHandler = (mouseEvent) => {\n      this.handler(mouseEvent)\n    }\n    const BackdropHandler = () => {\n      this._close()\n    }\n    const TransitionHandler = () => {\n      if (!this.alive && this._closeInvoked) {\n        this._cleanShadow()\n        this._closeInvoked = false\n      }\n    }\n    this._register({\n      ClickHandler,\n      BackdropHandler,\n      TransitionHandler\n    })\n\n    this.button.addEventListener(this.event, this._handlers.ClickHandler)\n    this.backdropElement.addEventListener(this.event, this._handlers.BackdropHandler)\n    if (this._initialState === `-${this._width('px')}`) {\n      this.nav.addEventListener(TRANS_END, this._handlers.TransitionHandler)\n    }\n    return 0\n  }\n\n  deactivate() {\n    throw new ReferenceError('cannot deactivate a default service. This service must be kept running')\n  }\n\n  forceDeactivate() {\n    this.button.removeEventListener(this.event, this._handlers.ClickHandler)\n    this.backdropElement.removeEventListener(this.event, this._handlers.BackdropHandler)\n    if (this._initialState === `-${this._width('px')}`) {\n      this.nav.removeEventListener(TRANS_END, this._handlers.TransitionHandler)\n    }\n    this._register(null)\n  }\n\n  handler(mouseEvent) {\n    mouseEvent.preventDefault()\n    const state = NavService._toNum(NavService.css(this.nav, this.direction))\n    if (state < ZERO) {\n      const buttonHash = getAttribute(this.button, 'href') || getData(this.button, 'data-href')\n      if (buttonHash) {\n        WINDOW.location.hash = buttonHash\n      }\n      this._open()\n    } else {\n      this._close()\n    }\n  }\n\n  static css(el, property, style) {\n    return css(el, property, style)\n  }\n\n  static _toNum(val) {\n    val = val.replace(/[^\\d]*$/, '')\n    return /\\.(?=\\d)/.test(val) ? Math.round(parseFloat(val)) : parseInt(val, 10)\n  }\n\n  _width(unit) {\n    unit = unit || ''\n    return this.width + unit\n  }\n\n  _register(handler) {\n    this._handlers = handler\n  }\n\n  _open() {\n    const style = {\n      [this.direction]: ZERO,\n      [EFFECT]: this.transition,\n      boxShadow: NAV_BOX_SHADOW[this.direction]\n    }\n    NavService.css(this.nav, style)\n    this.backdrop.show(this.options.TRANSITION)\n    NavService.css(this.body, 'overflow', 'hidden')\n    // callback for when nav is shown\n    if (this.state.isRegisteredEvent(NAVSTATE_EVENTS.show)) {\n      this.state.getStateEventHandler(NAVSTATE_EVENTS.show)()\n    }\n    this.alive = true\n    this.state.activity.run()\n  }\n\n  _close() {\n    const style = {\n      [this.direction]: this._initialState,\n      [EFFECT]: this.transition\n      // don't clean shadow here\n      // it's transitioning\n    }\n    NavService.css(this.nav, style)\n    this.backdrop.hide(this.options.TRANSITION)\n    NavService.css(this.body, 'overflow', 'initial')\n    // callback for when nav is hidden\n    if (this.state.isRegisteredEvent(NAVSTATE_EVENTS.hide)) {\n      this.state.getStateEventHandler(NAVSTATE_EVENTS.hide)()\n    }\n    this.alive = false\n    this._closeInvoked = true\n    this.state.activity.derun()\n  }\n\n  _cleanShadow() {\n    NavService.css(this.nav, 'boxShadow', 'none')\n  }\n}\n\nexport default NavService\n","import {\n  WINDOW,\n  getAttribute,\n  getData\n} from '../util'\n\nclass PopService {\n  constructor(parentService, options, state) {\n    this.options = options\n    this.state = state\n    this.parentService = parentService\n    this.button = options.INIT_ELEM\n    this.event = 'hashchange'\n    this.handler = null\n  }\n\n  activate() {\n    const handler = (hashChangeEvent) => {\n      this._hashchange(hashChangeEvent)\n    }\n    this._register(handler)\n    WINDOW.addEventListener(this.event, this.handler, true)\n    return 0\n  }\n\n  deactivate() {\n    WINDOW.removeEventListener(this.event, this.handler, true)\n    this._register(null)\n    return 0\n  }\n\n  /**\n   * @param {HashChangeEvent} hashChangeEvent Event object\n   * @returns {void}\n   */\n  _hashchange(hashChangeEvent) {\n    const oldHash = PopService._getHash(hashChangeEvent.oldURL)\n    if (oldHash === (getAttribute(this.button, 'href') ||\n    getData(this.button, 'data-href')) &&\n    this.state.activity.isRunning()) {\n      hashChangeEvent.stopImmediatePropagation()\n      this.parentService._close()\n    }\n  }\n\n  _register(handler) {\n    this.handler = handler\n  }\n\n  static _getHash(uri) {\n    let hash = uri\n    const indexOfHash = hash.lastIndexOf('#')\n    hash = indexOfHash !== -1 ? hash.slice(indexOfHash).replace(/(?:[^\\w\\d-]+)$/) : null\n    return hash\n  }\n}\n\nexport default PopService\n","const EventInterface = {\n  SHOW: 'show',\n  HIDE: 'hide'\n}\n\nexport default class State {\n  constructor(activity) {\n    this.activity = activity // activity manager\n    this._stateEventRegistry = {\n      [EventInterface.SHOW]: null,\n      [EventInterface.HIDE]: null\n    }\n  }\n\n  set onshow(val) {\n    if (typeof val !== 'function') {\n      throw new TypeError('value is not a callable type')\n    }\n    this._stateEventRegistry.show = val\n    return true\n  }\n\n  set onhide(val) {\n    if (typeof val !== 'function') {\n      throw new TypeError('value is not a callable type')\n    }\n    this._stateEventRegistry.hide = val\n    return true\n  }\n\n  getStateEventHandler(type) {\n    if (Object.values(EventInterface).indexOf(type) !== -1) {\n      return this._stateEventRegistry[type]\n    }\n    throw new Error('unknown event type')\n  }\n\n  isRegisteredEvent(type) {\n    return typeof this._stateEventRegistry[type] === 'function'\n  }\n}\n","import {\n  $,\n  ActivityManager,\n  DIRECTIONS,\n  NAVSTATE_EVENTS,\n  WINDOW,\n  css,\n  getData\n} from './../util'\nimport {\n  Backdrop\n} from './backdrop'\nimport NavDrawer from './drawer'\nimport NavService from './navservice'\nimport PopService from './popservice'\nimport State from './state'\n\nconst BACKDROP = 'backdrop'\nconst MEDIA_DRAW = 'data-max-width'\nconst CLASS_TYPE = '[object NavCard]'\nconst NAME = 'Nav'\nconst NAV = WINDOW[NAME] || null\n\nclass NavCard {\n  constructor(src, dest) {\n    /**\n     * Covert Backdrop\n     * ----------------\n     * Just incase `options.backdrop = false`\n     * prevents multiple `if` statements\n     * so we don't have to check whether\n     * backdrop is enabled anytime we want to access it.\n     *\n     * Insert into DOM only:\n     * when `options.backdrop = true`\n     * `options.backdropClass` is undefined\n     */\n    this.backdrop = document.createElement('div')\n    this.backdrop.className = BACKDROP\n    css(this.backdrop, {\n      background: 'rgba(0,0,0,.4)',\n      height: '100%',\n      width: '100%',\n      display: 'none',\n      position: 'fixed',\n      top: 0,\n      left: 0\n    })\n    this.src = src\n    this.dest = dest\n    this.body = document.body\n    this.Drawer = null\n    this.SheetService = null\n    this.PopService = null\n    this._Activity = new ActivityManager(this)\n    this.State = new State(this._Activity)\n  }\n\n  static defaultConfig = {\n    transition: 500,\n    direction: -1,\n    useBackdrop: false,\n    backdrop: null,\n    dest: null,\n    scrollableContainer: null,\n    maxStartArea: 25,\n    threshold: 1 / 2,\n    unit: 'px',\n    CustomDrawer: null\n  }\n\n  static SERVICES = {\n    Default: 0x20,\n    Drawer: 0x40,\n    Pop: 0x80\n  }\n\n  setup(options) {\n    if (!this.src) {\n      throw new TypeError(\n        `expected ${NAME} to be constructed with at least 'src' argument:\n        expected 'src' to be selector string or HTMLElement.\n          constructor(src: string | HTMLElement, dest?: string | HTMLElement)`\n      )\n    }\n\n    const opts = typeof Object.assign === 'function' ? Object.assign({}, NavCard.defaultConfig) : {\n      ...NavCard.defaultConfig\n    }\n\n    if (options && typeof options === 'object') {\n      for (const prop of Object.keys(options)) {\n        if (Object.prototype.hasOwnProperty.call(opts, prop)) {\n          opts[prop] = options[prop]\n        } else {\n          continue\n        }\n      }\n    }\n\n    this.dest = this.dest ? this.dest : opts.dest\n\n    const srcEl = this.src instanceof HTMLElement ? this.src : $(this.src)\n    const destEl = this.dest instanceof HTMLElement ? this.dest : $(this.dest)\n    let maxWidth  = getData(destEl, MEDIA_DRAW)\n\n    if (opts.useBackdrop) {\n      const backdropclass = opts.backdrop || false\n      // if `opts.useBackdrop` and no `backdrop` given\n      // append a custom backdrop\n      if (!backdropclass) {\n        destEl.insertAdjacentElement('beforeBegin', this.backdrop)\n      } else if (typeof backdropclass === 'string') {\n        // check if backdropclass is normal string or css class selector\n        const backdrop =  /^\\./.test(backdropclass) ? backdropclass : `.${backdropclass}`\n        this.backdrop = $(backdrop)\n      } else if (backdropclass instanceof HTMLElement) {\n        this.backdrop = backdropclass\n      } else {\n        throw new TypeError('expected \\'options.backdrop\\' to be a selector string or HTMLElement.')\n      }\n    }\n\n    maxWidth = /px$/.test(maxWidth) ? maxWidth : `${maxWidth}px`\n    const defaultOptions = {\n      ELEMENT: destEl,\n      INIT_ELEM: srcEl,\n      BACKDROP: new Backdrop(this.backdrop),\n      BODY: this.body,\n      TRANSITION: opts.transition,\n      DIRECTION: DIRECTIONS[opts.direction],\n      unit: opts.unit\n    }\n    const drawerOptions = {\n      ...defaultOptions,\n      MAX_WIDTH: maxWidth,\n      DIRECTION: opts.direction,\n      maxStartArea: opts.maxStartArea,\n      threshold: opts.threshold,\n      scrollableContainer: opts.scrollableContainer,\n      CustomDrawer: opts.CustomDrawer\n    }\n    const hashOptions = {\n      INIT_ELEM: defaultOptions.INIT_ELEM\n    }\n\n    return new NavMountWorker(this, {\n      defaultOptions,\n      drawerOptions,\n      hashOptions\n    })\n  }\n\n  terminate(service) {\n    service |= 0\n    if (service & NavCard.SERVICES.Default && this.SheetService instanceof NavService) {\n      this.SheetService.deactivate()\n    }\n    if (service & NavCard.SERVICES.Drawer && this.Drawer instanceof NavDrawer) {\n      this.Drawer.deactivate()\n    }\n    if (service & NavCard.SERVICES.Hash && this.PopService instanceof PopService) {\n      this.PopService.deactivate()\n    }\n    if (!service) {\n      throw new Error('a service id is required')\n    }\n  }\n\n  toString() {\n    return CLASS_TYPE\n  }\n\n  static namespace(name) {\n    WINDOW[name] = WINDOW[name] || {}\n    WINDOW[name][NAME] = NavCard\n    WINDOW[NAME] = NAV\n  }\n\n  _drawerAPI(options) {\n    const {\n      CustomDrawer: Drawer\n    } = options\n    this.Drawer = Drawer && typeof Drawer === 'object' ? new Drawer(options, this.State) : new NavDrawer(options, this.State)\n    return {\n      activate: () => this.Drawer.activate(),\n      deactivate: () => this.Drawer.deactivate()\n    }\n  }\n\n  _hashAPI(options) {\n    this.PopService = new PopService(this.SheetService, options, this.State)\n    return {\n      activate: () => this.PopService.activate(),\n      deactivate: () => this.PopService.deactivate()\n    }\n  }\n\n  _defaultAPI(options) {\n    this.SheetService = new NavService(options, this.State)\n    return {\n      activate: () => this.SheetService.activate(),\n      deactivate: () => this.SheetService.deactivate()\n    }\n  }\n}\n\nclass NavMountWorker {\n  constructor(borrowedContext, options) {\n    this.$this = borrowedContext\n    this.options = options\n  }\n\n  mount() {\n    const DEFAULT_ACTIVE = !this.$this._defaultAPI(this.options.defaultOptions).activate()\n    const DRAWER_ACTIVE = !this.$this._drawerAPI(this.options.drawerOptions).activate()\n    const HASH_ACTIVE = !this.$this._hashAPI(this.options.hashOptions).activate()\n    return new Promise((resolve, reject) => {\n      if (!(DEFAULT_ACTIVE && DRAWER_ACTIVE && HASH_ACTIVE)) {\n        reject(new Error('one or more services could not activate'))\n        return\n      }\n      resolve(new NavStateEvent(this.$this, this.$this.State))\n    })\n  }\n\n  unmount() {\n    this.$this.SheetService.forceDeactivate()\n    this.$this.Drawer.deactivate()\n    this.$this.PopService.deactivate()\n  }\n\n  toString() {\n    return '[object NavMountWorker]'\n  }\n}\n\nclass NavStateEvent {\n  events = [NAVSTATE_EVENTS.show, NAVSTATE_EVENTS.hide]\n  constructor($this, state) {\n    this.$this = $this\n    this._State = state\n  }\n  on(event, handle = () => false) {\n    if (!(this.events.indexOf(event) + 1)) {\n      throw new Error(`unknown event '${event}'`)\n    }\n    this._State[`on${event}`] = handle.bind(this.$this)\n  }\n  off(event) {\n    if (!(this.events.indexOf(event) + 1)) {\n      throw new Error(`unknown event '${event}'`)\n    }\n    this._State[`on${event}`] = null\n  }\n}\n\nexport default NavCard\n"],"names":["Backdrop","backdrop","show","time","css","display","opacity","transition","hide","window","setTimeout","setOpacity","val","ZERO","KILO","MIN_TIME_TO_OVERRIDE_BELOWTHRESHOLD","MIN_POSITIVE_DISPLACEMENT","MIN_NEGATIVE_DISPLACEMENT","TRANSITION_STYLE","EFFECT","OVERFLOW","TRANS_TIMING","TRANS_TEMPLATE","HIDDEN","SCROLL","AUTO","HREF","HASH_ATTR","START","MOVE","THRESHOLD","BELOW_THRESHOLD","MIN_SPEED","MAX_SPEED","NavDrawer","options","state","element","ELEMENT","_body","BODY","_backdrop","BACKDROP","direction","DIRECTION","_checkDirection","directionString","DIRECTIONS","bound","_bound","o","SIZE","elementSize","TARGET","document","drawer","Drawer","SnappedDrawer","DrawerManagementStore","pushActivity","activity","activate","on","_startHandler","_moveHandler","_threshold","_belowThreshold","setContext","setServiceID","id","deactivate","service","response","lock","run","dimension","boxShadow","NAV_BOX_SHADOW","style","overflow","rectangle","curPos","UP","DOWN","coordsY","y2","coordsX","x2","RIGHT","WIN_SIZE","WINDOW","screen","width","stateObj","rect","isOpen","_calcSpeed","TIMING","_hide","_show","isClosed","overallEventTime","MTTOB","MPD","MND","displacement","displacementY","displacementX","LOGIC","LEFT","greaterWidth","_overrideBelowThresh","_showPrep","_hidePrep","oppositeDimension","derun","TRANSITION","lower","_setState","isRegisteredEvent","NAVSTATE_EVENTS","getStateEventHandler","buttonHash","getAttribute","INIT_ELEM","getData","location","hash","distance","distanceRemain","Math","sign","newTime","RangeError","mode","Error","axis","offsetHeight","offsetWidth","upperBound","lowerBound","offsetLeft","Bound","TRANS_END","NavService","nav","button","body","backdropElement","event","transTime","alive","_closeInvoked","_initialState","_handlers","ClickHandler","mouseEvent","handler","BackdropHandler","_close","TransitionHandler","_cleanShadow","_register","addEventListener","_width","ReferenceError","forceDeactivate","removeEventListener","preventDefault","_toNum","_open","el","property","replace","test","round","parseFloat","parseInt","unit","PopService","parentService","hashChangeEvent","_hashchange","oldHash","_getHash","oldURL","isRunning","stopImmediatePropagation","uri","indexOfHash","lastIndexOf","slice","EventInterface","SHOW","HIDE","State","_stateEventRegistry","type","Object","values","indexOf","TypeError","MEDIA_DRAW","CLASS_TYPE","NAME","NAV","NavCard","src","dest","createElement","className","background","height","position","top","left","SheetService","_Activity","ActivityManager","setup","opts","assign","defaultConfig","keys","prop","prototype","hasOwnProperty","call","srcEl","HTMLElement","$","destEl","maxWidth","useBackdrop","backdropclass","insertAdjacentElement","defaultOptions","drawerOptions","MAX_WIDTH","maxStartArea","threshold","scrollableContainer","CustomDrawer","hashOptions","NavMountWorker","terminate","SERVICES","Default","Hash","toString","namespace","name","_drawerAPI","_hashAPI","_defaultAPI","Pop","borrowedContext","$this","mount","DEFAULT_ACTIVE","DRAWER_ACTIVE","HASH_ACTIVE","Promise","resolve","reject","NavStateEvent","unmount","_State","handle","events","bind","off"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MAIaA,QAAb;EAAA;EAAA;EACE,oBAAYC,QAAZ,EAAsB;EACpB,SAAKA,QAAL,GAAgBA,QAAhB;EACD;;EAHH;;EAAA,SAKEC,IALF,GAKE,cAAKC,IAAL,EAAW;EACTC,IAAAA,WAAG,CAAC,KAAKH,QAAN,EAAgB;EACjBI,MAAAA,OAAO,EAAE,OADQ;EAEjBC,MAAAA,OAAO,EAAE,CAFQ;EAGjBC,MAAAA,UAAU,sBAAoBJ,IAAI,GAAG,GAA3B;EAHO,KAAhB,CAAH;EAKD,GAXH;;EAAA,SAaEK,IAbF,GAaE,cAAKL,IAAL,EAAW;EAAA;;EACTC,IAAAA,WAAG,CAAC,KAAKH,QAAN,EAAgB;EACjBK,MAAAA,OAAO,EAAE,CADQ;EAEjBC,MAAAA,UAAU,sBAAoBJ,IAAI,GAAG,GAA3B;EAFO,KAAhB,CAAH;EAIAM,IAAAA,MAAM,CAACC,UAAP,CAAkB,YAAM;EACtBN,MAAAA,WAAG,CAAC,KAAI,CAACH,QAAN,EAAgB;EACjBI,QAAAA,OAAO,EAAE;EADQ,OAAhB,CAAH;EAGD,KAJD,EAIGF,IAJH;EAKD,GAvBH;;EAAA,SAyBEQ,UAzBF,GAyBE,oBAAWC,GAAX,EAAgB;EACdR,IAAAA,WAAG,CAAC,KAAKH,QAAN,EAAgB;EACjBI,MAAAA,OAAO,EAAE,OADQ;EAEjBC,MAAAA,OAAO,EAAEM,GAFQ;EAGjBL,MAAAA,UAAU,EAAE;EAHK,KAAhB,CAAH;EAKD,GA/BH;;EAAA;EAAA;;ECQA,IAAMM,IAAI,GAAG,CAAb;EACA,IAAMC,IAAI,GAAG,GAAb;EACA,IAAMC,mCAAmC,GAAG,GAA5C;EACA,IAAMC,yBAAyB,GAAG,EAAlC;EACA,IAAMC,yBAAyB,GAAG,CAACD,yBAAnC;EACA,IAAME,gBAAgB,GAAG,QAAzB;;EACA,IAAMC,MAAM,GAAG,YAAf;EACA,IAAMC,QAAQ,GAAG,UAAjB;EACA,IAAMC,YAAY,GAAG,MAArB;EACA,IAAMC,cAAc,GAAMJ,gBAAN,SAA0BG,YAA9C;EACA,IAAME,MAAM,GAAG,QAAf;EACA,IAAMC,MAAM,GAAG,QAAf;EACA,IAAMC,IAAI,GAAG,MAAb;EACA,IAAMC,IAAI,GAAG,MAAb;EACA,IAAMC,SAAS,aAAWD,IAA1B;EACA,IAAME,KAAK,GAAG,OAAd;EACA,IAAMC,IAAI,GAAG,MAAb;EACA,IAAMC,SAAS,GAAG,WAAlB;EACA,IAAMC,eAAe,aAAWD,SAAhC;EACA,IAAME,SAAS,GAAG,GAAlB;EACA,IAAMC,SAAS,GAAG,GAAlB;;MAEMC;;;EACJ;;;;;;;;EAQA,qBAAYC,OAAZ,EAAqBC,KAArB,EAA4B;EAC1B,SAAKD,OAAL,GAAeA,OAAf;EACA,SAAKC,KAAL,GAAaA,KAAb;EACA,SAAKC,OAAL,GAAe,KAAKF,OAAL,CAAaG,OAA5B;EACA,SAAKC,KAAL,GAAa,KAAKJ,OAAL,CAAaK,IAA1B;EACA,SAAKC,SAAL,GAAiB,KAAKN,OAAL,CAAaO,QAA9B;EACA,SAAKC,SAAL,GAAiB,KAAKR,OAAL,CAAaS,SAA9B;;EAEA,SAAKC,eAAL;;EAEA,SAAKC,eAAL,GAAuBC,kBAAU,CAAC,KAAKJ,SAAN,CAAjC;EACA,SAAKK,KAAL,GAAa,KAAKC,MAAlB;;EAEA,QAAMC,CAAC,gBACFf,OADE;EAELgB,MAAAA,IAAI,EAAE,KAAKC,WAFN;EAGLC,MAAAA,MAAM,EAAEC;EAHH,MAAP;;EAKA,SAAKC,MAAL,GAAc,IAAIC,MAAM,CAACC,aAAX,CAAyBP,CAAzB,EAA4B,KAAKF,KAAjC,EAAwCQ,MAAM,CAACE,qBAA/C,CAAd;EACAF,IAAAA,MAAM,CAACE,qBAAP,CAA6BC,YAA7B,CAA0C,KAAKvB,KAAL,CAAWwB,QAArD;EACA,SAAKrD,UAAL,GAAqB,KAAKuC,eAA1B,SAA6CxB,cAA7C;EACD;;;;WAEDuC,WAAA,oBAAW;EACT,SAAKN,MAAL,CAAYO,EAAZ,CAAelC,KAAf,EAAsB,KAAKmC,aAA3B,EACGD,EADH,CACMjC,IADN,EACY,KAAKmC,YADjB,EAEGF,EAFH,CAEMhC,SAFN,EAEiB,KAAKmC,UAFtB,EAGGH,EAHH,CAGM/B,eAHN,EAGuB,KAAKmC,eAH5B,EAIGC,UAJH,CAIc,IAJd,EAKGN,QALH;EAMA,SAAKN,MAAL,CAAYa,YAAZ,CAAyB,KAAKhC,KAAL,CAAWwB,QAAX,CAAoBS,EAA7C;EACA,WAAO,CAAP;EACD;;WAEDC,aAAA,sBAAa;EACX,SAAKf,MAAL,CAAYe,UAAZ;EACA,WAAO,CAAP;EACD;;WAuBDP,gBAAA,uBAAcQ,OAAd,EAAuBC,QAAvB,EAAiC;EAAA;;EAC/BD,IAAAA,OAAO,CAACE,IAAR;EACA,SAAKrC,KAAL,CAAWwB,QAAX,CAAoBc,GAApB;EACAtE,IAAAA,WAAG,CAAC,KAAKiC,OAAN,mBACA,KAAKS,eADL,IACuB0B,QAAQ,CAACG,SADhC,OAEDC,SAFC,GAEUC,sBAAc,CAAC,KAAK/B,eAAN,CAFxB,OAGA3B,MAHA,IAGS,KAAKZ,UAHd,QAAH;EAKA,SAAKgC,KAAL,CAAWuC,KAAX,CAAiBC,QAAjB,GAA4BxD,MAA5B;EACD;;WAEDyC,eAAA,sBAAaO,OAAb,EAAsBC,QAAtB,EAAgCQ,SAAhC,EAA2C;EAAA;;EACzCT,IAAAA,OAAO,CAACE,IAAR;EACA,QAAIQ,MAAM,GAAG,KAAKtC,SAAL,KAAmBa,MAAM,CAAC0B,EAA1B,IAAgC,KAAKvC,SAAL,KAAmBa,MAAM,CAAC2B,IAA1D,GAAiEH,SAAS,CAACI,OAAV,CAAkBC,EAAnF,GAAwFL,SAAS,CAACM,OAAV,CAAkBC,EAAvH;EACAnF,IAAAA,WAAG,CAAC,KAAKiC,OAAN,qBACA,KAAKS,eADL,IACuB0B,QAAQ,CAACG,SADhC,QAEAxD,MAFA,IAES,MAFT,QAGAC,QAHA,IAGWG,MAHX,SAAH;;EAKA,QAAI,KAAKoB,SAAL,KAAmBa,MAAM,CAACgC,KAA9B,EAAqC;EACnC,UAAMC,QAAQ,GAAGC,cAAM,CAACC,MAAP,CAAcC,KAA/B;EACAX,MAAAA,MAAM,GAAGQ,QAAQ,GAAGR,MAApB;;EACA,WAAKxC,SAAL,CAAe9B,UAAf,CAA0BsE,MAAM,GAAG,KAAK7B,WAAxC;;EACA;EACD;;EACD,SAAKX,SAAL,CAAe9B,UAAf,CAA0BsE,MAAM,GAAG,KAAK7B,WAAxC;EACD;;WAEDa,aAAA,oBAAWM,OAAX,EAAoBnC,KAApB,EAA2ByD,QAA3B,EAAqCC,IAArC,EAA2C;EACzCvB,IAAAA,OAAO,CAACE,IAAR;EACA,QAAMsB,MAAM,GAAG3D,KAAK,CAAC,CAAD,CAAL,KAAa,MAA5B;EACA,QAAMD,OAAO,GAAG;EACd0D,MAAAA,QAAQ,EAARA,QADc;EAEdtF,MAAAA,UAAU,EAAK,KAAKuC,eAAV,SAA6B5B,gBAA7B,SAAiD,KAAK8E,UAAL,CAAgBH,QAAQ,CAACI,MAAzB,EAAiCH,IAAI,CAACF,KAAtC,IAA+C9E,IAAhG;EAFI,KAAhB;;EAIA,QAAIiF,MAAJ,EAAY;EACV,WAAKG,KAAL,CAAW/D,OAAX;EACD,KAFD,MAEO;EACL,WAAKgE,KAAL,CAAWhE,OAAX;EACD;EACF;;WAED+B,kBAAA,yBAAgBK,OAAhB,EAAyBnC,KAAzB,EAAgCyD,QAAhC,EAA0CC,IAA1C,EAAgD;EAC9CvB,IAAAA,OAAO,CAACE,IAAR;EACA,QAAM2B,QAAQ,GAAGhE,KAAK,CAAC,CAAD,CAAL,KAAa,MAA9B;EACA,QAAMiE,gBAAgB,GAAGR,QAAQ,CAACI,MAAlC;EACA,QAAMK,KAAK,GAAGvF,mCAAd;EACA,QAAMwF,GAAG,GAAGvF,yBAAZ;EACA,QAAMwF,GAAG,GAAGvF,yBAAZ;EACA,QAAMwF,YAAY,GAAG,KAAK9D,SAAL,KAAmBa,MAAM,CAAC0B,EAA1B,IAAgC,KAAKvC,SAAL,KAAmBa,MAAM,CAAC2B,IAA1D,GACjBW,IAAI,CAACY,aADY,GACIZ,IAAI,CAACa,aAD9B;EAEA,QAAMxE,OAAO,GAAG;EACd0D,MAAAA,QAAQ,EAARA,QADc;EAEdtF,MAAAA,UAAU,EAAK,KAAKuC,eAAV,SAA6B5B,gBAA7B,SAAiD,KAAK8E,UAAL,CAAgBH,QAAQ,CAACI,MAAzB,EAAiCH,IAAI,CAACF,KAAtC,IAA+C9E,IAAhG;EAFI,KAAhB;EAIA,QAAI8F,KAAJ;;EACA,QAAI,KAAKjE,SAAL,KAAmBa,MAAM,CAACqD,IAA1B,IAAkCT,QAAlC,IAA8C,KAAKzD,SAAL,KAAmBa,MAAM,CAACgC,KAA1B,IAAmC,CAACY,QAAtF,EAAgG;EAC9FQ,MAAAA,KAAK,GAAIH,YAAY,GAAG5F,IAAf,IAAuB4F,YAAY,IAAIF,GAAvC,IAA8CT,IAAI,CAACgB,YAA5D;EACD,KAFD,MAEO;EACLF,MAAAA,KAAK,GAAGH,YAAY,GAAG5F,IAAf,IAAuB4F,YAAY,IAAID,GAAvC,IAA8CV,IAAI,CAACgB,YAA3D;EACD;;EAED,QAAIT,gBAAgB,GAAGvF,IAAnB,GAA0BwF,KAA9B,EAAqC;EACnC,UAAIM,KAAJ,EAAW;EACT,aAAKG,oBAAL,CAA0B,CAACX,QAA3B,EAAqCjE,OAArC;EACD,OAFD,MAEO;EACL,YAAIiE,QAAJ,EAAc;EACZ;EACA,eAAKF,KAAL,CAAW/D,OAAX;;EACA;EACD,SALI;;;EAOL,aAAKgE,KAAL,CAAWhE,OAAX;EACD;EACF,KAZD,MAYO;EACL,UAAIiE,QAAJ,EAAc;EACZ;EACA,aAAKF,KAAL,CAAW/D,OAAX;;EACA;EACD,OALI;;;EAOL,WAAKgE,KAAL,CAAWhE,OAAX;EACD;EACF;;WAEDgE,QAAA,eAAMhE,OAAN,EAAe;EACb,SAAK6E,SAAL,CAAe7E,OAAf;;EACA,SAAKE,OAAL,CAAayC,KAAb,CAAmB,KAAKhC,eAAxB,IAA2CX,OAAO,CAAC0D,QAAR,CAAiBlB,SAA5D;EACD;;WAEDuB,QAAA,eAAM/D,OAAN,EAAe;EACb,SAAK8E,SAAL,CAAe9E,OAAf;;EACA,SAAKE,OAAL,CAAayC,KAAb,CAAmB,KAAKhC,eAAxB,IAA2CX,OAAO,CAAC0D,QAAR,CAAiBlB,SAA5D;EACD;;WAEDoC,uBAAA,8BAAqBhB,MAArB,EAA6B5D,OAA7B,EAAsC;EACpC,QAAI4D,MAAJ,EAAY;EACV,WAAKkB,SAAL,CAAe9E,OAAf;;EACA,WAAKE,OAAL,CAAayC,KAAb,CAAmB,KAAKhC,eAAxB,IAA2CX,OAAO,CAAC0D,QAAR,CAAiBqB,iBAA5D;EACD,KAHD,MAGO;EACL,WAAKF,SAAL,CAAe7E,OAAf;;EACA,WAAKE,OAAL,CAAayC,KAAb,CAAmB,KAAKhC,eAAxB,IAA2CX,OAAO,CAAC0D,QAAR,CAAiBqB,iBAA5D;EACD;EACF;;WAEDD,YAAA,mBAAU9E,OAAV,EAAmB;EAAA;;EACjB,SAAKC,KAAL,CAAWwB,QAAX,CAAoBuD,KAApB;EACA,SAAK5E,KAAL,CAAWuC,KAAX,CAAiBC,QAAjB,GAA4BvD,MAA5B;;EACA,SAAKiB,SAAL,CAAejC,IAAf,CAAoB,KAAK2B,OAAL,CAAaiF,UAAjC;;EACAhH,IAAAA,WAAG,CAAC,KAAKiC,OAAN,qBACAlB,MADA,IACSgB,OAAO,CAAC5B,UADjB,QAEAa,QAFA,IAEWK,IAFX,SAAH;;EAIA,QAAI,CAAC,KAAKuB,KAAL,CAAWqE,KAAhB,EAAuB;EACrB,WAAKhF,OAAL,CAAayC,KAAb,CAAmBF,SAAnB,GAA+B,MAA/B;EACD;;EACD,SAAK0C,SAAL,CAAe,OAAf,EAXiB;;;EAajB,QAAI,KAAKlF,KAAL,CAAWmF,iBAAX,CAA6BC,uBAAe,CAAChH,IAA7C,CAAJ,EAAwD;EACtD,WAAK4B,KAAL,CAAWqF,oBAAX,CAAgCD,uBAAe,CAAChH,IAAhD;EACD;EACF;;WAEDwG,YAAA,mBAAU7E,OAAV,EAAmB;EAAA;;EACjB,QAAMuF,UAAU,GAAGC,oBAAY,CAAC,KAAKxF,OAAL,CAAayF,SAAd,EAAyBlG,IAAzB,CAAZ,IAA8CmG,eAAO,CAAC,KAAK1F,OAAL,CAAayF,SAAd,EAAyBjG,SAAzB,CAAxE;;EACA,QAAI+F,UAAJ,EAAgB;EACdhC,MAAAA,cAAM,CAACoC,QAAP,CAAgBC,IAAhB,GAAuBL,UAAvB;EACD;;EACD,SAAKnF,KAAL,CAAWuC,KAAX,CAAiBC,QAAjB,GAA4BxD,MAA5B;;EACA,SAAKkB,SAAL,CAAevC,IAAf,CAAoB,KAAKiC,OAAL,CAAaiF,UAAjC;;EACAhH,IAAAA,WAAG,CAAC,KAAKiC,OAAN,qBACAlB,MADA,IACSgB,OAAO,CAAC5B,UADjB,QAEAa,QAFA,IAEWK,IAFX,SAAH;;EAIA,SAAK6F,SAAL,CAAe,MAAf,EAXiB;;;EAajB,QAAI,KAAKlF,KAAL,CAAWmF,iBAAX,CAA6BC,uBAAe,CAACtH,IAA7C,CAAJ,EAAwD;EACtD,WAAKkC,KAAL,CAAWqF,oBAAX,CAAgCD,uBAAe,CAACtH,IAAhD;EACD;EACF;;WAED8F,aAAA,oBAAW7F,IAAX,EAAiB6H,QAAjB,EAA2B;EACzB,QAAMC,cAAc,GAAG,KAAK7E,WAAL,GAAmB4E,QAA1C;;EACA,QAAI,CAACE,IAAI,CAACC,IAAL,CAAUF,cAAV,CAAL,EAAgC;EAC9B,UAAIG,OAAO,GAAGH,cAAc,GAAG9H,IAAjB,GAAwB6H,QAAtC;;EACA,UAAII,OAAO,GAAGnG,SAAd,EAAyB;EACvBmG,QAAAA,OAAO,GAAGnG,SAAV;EACD,OAFD,MAEO,IAAImG,OAAO,GAAGpG,SAAd,EAAyB;EAC9BoG,QAAAA,OAAO,GAAGpG,SAAV;EACD;;EACD,aAAOoG,OAAP;EACD;;EACD,WAAO,CAAP;EACD;;WAEDvF,kBAAA,2BAAkB;EAChB,QAAI,KAAKF,SAAL,KAAmBa,MAAM,CAACqD,IAA1B,IAAkC,KAAKlE,SAAL,KAAmBa,MAAM,CAACgC,KAAhE,EAAuE;EACrE,YAAM,IAAI6C,UAAJ,CAAe,wBAAf,CAAN;EACD;EACF;;WAEDf,YAAA,mBAAUgB,IAAV,EAAgB;EACd,YAAQA,IAAR;EACE,WAAK,MAAL;EACE,aAAKlG,KAAL,CAAWwB,QAAX,CAAoBc,GAApB;EACA;;EACF,WAAK,OAAL;EACE,aAAKtC,KAAL,CAAWwB,QAAX,CAAoBuD,KAApB;EACA;;EACF;EACE,cAAM,IAAIoB,KAAJ,CAAU,0BAAV,CAAN;EARJ;EAUD;;;;0BAjMiB;EAChB,UAAMC,IAAI,GAAG,KAAK7F,SAAlB;;EACA,UAAI6F,IAAI,KAAKhF,MAAM,CAAC0B,EAAhB,IAAsBsD,IAAI,KAAKhF,MAAM,CAAC2B,IAA1C,EAAgD;EAC9C,eAAO,KAAK9C,OAAL,CAAaoG,YAApB;EACD;;EACD,aAAO,KAAKpG,OAAL,CAAaqG,WAApB;EACD;EAED;;;;;;0BAGa;EACX,UAAMC,UAAU,GAAG,KAAKvF,WAAxB;;EACA,UAAI,KAAKT,SAAL,KAAmBa,MAAM,CAACgC,KAA9B,EAAqC;EACnC,YAAMoD,WAAU,GAAGlD,cAAM,CAACC,MAAP,CAAcC,KAAd,GAAsB,KAAKvD,OAAL,CAAawG,UAAtD;;EACA,eAAO,IAAIC,aAAJ,CAAUF,WAAV,EAAsBD,UAAtB,CAAP;EACD;;EACD,UAAMC,UAAU,GAAGD,UAAU,GAAG,KAAKtG,OAAL,CAAawG,UAA7C;EACA,aAAO,IAAIC,aAAJ,CAAUF,UAAV,EAAsBD,UAAtB,CAAP;EACD;;;;;;EC3FH,IAAMzH,kBAAgB,GAAG,4BAAzB;EACA,IAAMC,QAAM,GAAG,YAAf;EACA,IAAM4H,SAAS,GAAG,eAAlB;;MAEMC;;;EACJ,sBAAY7G,OAAZ,EAAqBC,KAArB,EAA4B;EAC1B,SAAKD,OAAL,GAAeA,OAAf;EACA,SAAKC,KAAL,GAAaA,KAAb;EACA,SAAK6G,GAAL,GAAW9G,OAAO,CAACG,OAAnB;EACA,SAAK4G,MAAL,GAAc/G,OAAO,CAACyF,SAAtB;EACA,SAAKuB,IAAL,GAAYhH,OAAO,CAACK,IAApB;EACA,SAAKvC,QAAL,GAAgBkC,OAAO,CAACO,QAAxB;EACA,SAAK0G,eAAL,GAAuB,KAAKnJ,QAAL,CAAcA,QAArC;EACA,SAAKoJ,KAAL,GAAa,OAAb;EACA,SAAK1G,SAAL,GAAiBR,OAAO,CAACS,SAAzB;EACA,SAAKgD,KAAL,GAAa,KAAKqD,GAAL,CAASP,WAAtB;EACA,SAAKY,SAAL,GAAiBnH,OAAO,CAACiF,UAAR,GAAqB,GAAtC;EACA,SAAK7G,UAAL,GAAqB,KAAKoC,SAA1B,SAAuCzB,kBAAvC,SAA2D,KAAKoI,SAAhE,OAZ0B;;EAc1B,SAAKC,KAAL,GAAa,KAAb,CAd0B;;EAgB1B;;;;EAGA,SAAKC,aAAL,GAAqB,KAArB;EACA;;;;;EAIA,SAAKC,aAAL,GAAqBT,UAAU,CAAC5I,GAAX,CAAe,KAAK6I,GAApB,EAAyB,KAAKtG,SAA9B,CAArB;EACA,SAAK+G,SAAL,GAAiB,IAAjB;EACD;;;;WAED7F,WAAA,oBAAW;EAAA;;EACT,QAAM8F,YAAY,GAAG,SAAfA,YAAe,CAACC,UAAD,EAAgB;EACnC,MAAA,KAAI,CAACC,OAAL,CAAaD,UAAb;EACD,KAFD;;EAGA,QAAME,eAAe,GAAG,SAAlBA,eAAkB,GAAM;EAC5B,MAAA,KAAI,CAACC,MAAL;EACD,KAFD;;EAGA,QAAMC,iBAAiB,GAAG,SAApBA,iBAAoB,GAAM;EAC9B,UAAI,CAAC,KAAI,CAACT,KAAN,IAAe,KAAI,CAACC,aAAxB,EAAuC;EACrC,QAAA,KAAI,CAACS,YAAL;;EACA,QAAA,KAAI,CAACT,aAAL,GAAqB,KAArB;EACD;EACF,KALD;;EAMA,SAAKU,SAAL,CAAe;EACbP,MAAAA,YAAY,EAAZA,YADa;EAEbG,MAAAA,eAAe,EAAfA,eAFa;EAGbE,MAAAA,iBAAiB,EAAjBA;EAHa,KAAf;;EAMA,SAAKd,MAAL,CAAYiB,gBAAZ,CAA6B,KAAKd,KAAlC,EAAyC,KAAKK,SAAL,CAAeC,YAAxD;EACA,SAAKP,eAAL,CAAqBe,gBAArB,CAAsC,KAAKd,KAA3C,EAAkD,KAAKK,SAAL,CAAeI,eAAjE;;EACA,QAAI,KAAKL,aAAL,WAA2B,KAAKW,MAAL,CAAY,IAAZ,CAA/B,EAAoD;EAClD,WAAKnB,GAAL,CAASkB,gBAAT,CAA0BpB,SAA1B,EAAqC,KAAKW,SAAL,CAAeM,iBAApD;EACD;;EACD,WAAO,CAAP;EACD;;WAED1F,aAAA,sBAAa;EACX,UAAM,IAAI+F,cAAJ,CAAmB,wEAAnB,CAAN;EACD;;WAEDC,kBAAA,2BAAkB;EAChB,SAAKpB,MAAL,CAAYqB,mBAAZ,CAAgC,KAAKlB,KAArC,EAA4C,KAAKK,SAAL,CAAeC,YAA3D;EACA,SAAKP,eAAL,CAAqBmB,mBAArB,CAAyC,KAAKlB,KAA9C,EAAqD,KAAKK,SAAL,CAAeI,eAApE;;EACA,QAAI,KAAKL,aAAL,WAA2B,KAAKW,MAAL,CAAY,IAAZ,CAA/B,EAAoD;EAClD,WAAKnB,GAAL,CAASsB,mBAAT,CAA6BxB,SAA7B,EAAwC,KAAKW,SAAL,CAAeM,iBAAvD;EACD;;EACD,SAAKE,SAAL,CAAe,IAAf;EACD;;WAEDL,UAAA,iBAAQD,UAAR,EAAoB;EAClBA,IAAAA,UAAU,CAACY,cAAX;;EACA,QAAMpI,KAAK,GAAG4G,UAAU,CAACyB,MAAX,CAAkBzB,UAAU,CAAC5I,GAAX,CAAe,KAAK6I,GAApB,EAAyB,KAAKtG,SAA9B,CAAlB,CAAd;;EACA,QAAIP,KAAK,GAAGvB,YAAZ,EAAkB;EAChB,UAAM6G,UAAU,GAAGC,oBAAY,CAAC,KAAKuB,MAAN,EAAc,MAAd,CAAZ,IAAqCrB,eAAO,CAAC,KAAKqB,MAAN,EAAc,WAAd,CAA/D;;EACA,UAAIxB,UAAJ,EAAgB;EACdhC,QAAAA,cAAM,CAACoC,QAAP,CAAgBC,IAAhB,GAAuBL,UAAvB;EACD;;EACD,WAAKgD,KAAL;EACD,KAND,MAMO;EACL,WAAKX,MAAL;EACD;EACF;;eAEM3J,MAAP,aAAWuK,EAAX,EAAeC,QAAf,EAAyB9F,KAAzB,EAAgC;EAC9B,WAAO1E,WAAG,CAACuK,EAAD,EAAKC,QAAL,EAAe9F,KAAf,CAAV;EACD;;eAEM2F,SAAP,gBAAc7J,GAAd,EAAmB;EACjBA,IAAAA,GAAG,GAAGA,GAAG,CAACiK,OAAJ,CAAY,SAAZ,EAAuB,EAAvB,CAAN;EACA,WAAO,WAAWC,IAAX,CAAgBlK,GAAhB,IAAuBsH,IAAI,CAAC6C,KAAL,CAAWC,UAAU,CAACpK,GAAD,CAArB,CAAvB,GAAqDqK,QAAQ,CAACrK,GAAD,EAAM,EAAN,CAApE;EACD;;WAEDwJ,SAAA,gBAAOc,IAAP,EAAa;EACXA,IAAAA,IAAI,GAAGA,IAAI,IAAI,EAAf;EACA,WAAO,KAAKtF,KAAL,GAAasF,IAApB;EACD;;WAEDhB,YAAA,mBAAUL,OAAV,EAAmB;EACjB,SAAKH,SAAL,GAAiBG,OAAjB;EACD;;WAEDa,QAAA,iBAAQ;EAAA;;EACN,QAAM5F,KAAK,wBACR,KAAKnC,SADG,IACS9B,YADT,SAERM,QAFQ,IAEC,KAAKZ,UAFN,SAGTqE,SAHS,GAGEC,sBAAc,CAAC,KAAKlC,SAAN,CAHhB,SAAX;EAKAqG,IAAAA,UAAU,CAAC5I,GAAX,CAAe,KAAK6I,GAApB,EAAyBnE,KAAzB;EACA,SAAK7E,QAAL,CAAcC,IAAd,CAAmB,KAAKiC,OAAL,CAAaiF,UAAhC;EACA4B,IAAAA,UAAU,CAAC5I,GAAX,CAAe,KAAK+I,IAApB,EAA0B,UAA1B,EAAsC,QAAtC,EARM;;EAUN,QAAI,KAAK/G,KAAL,CAAWmF,iBAAX,CAA6BC,uBAAe,CAACtH,IAA7C,CAAJ,EAAwD;EACtD,WAAKkC,KAAL,CAAWqF,oBAAX,CAAgCD,uBAAe,CAACtH,IAAhD;EACD;;EACD,SAAKqJ,KAAL,GAAa,IAAb;EACA,SAAKnH,KAAL,CAAWwB,QAAX,CAAoBc,GAApB;EACD;;WAEDqF,SAAA,kBAAS;EAAA;;EACP,QAAMjF,KAAK,0BACR,KAAKnC,SADG,IACS,KAAK8G,aADd,UAERtI,QAFQ,IAEC,KAAKZ,UAFN,UAAX;EAMAyI,IAAAA,UAAU,CAAC5I,GAAX,CAAe,KAAK6I,GAApB,EAAyBnE,KAAzB;EACA,SAAK7E,QAAL,CAAcO,IAAd,CAAmB,KAAK2B,OAAL,CAAaiF,UAAhC;EACA4B,IAAAA,UAAU,CAAC5I,GAAX,CAAe,KAAK+I,IAApB,EAA0B,UAA1B,EAAsC,SAAtC,EATO;;EAWP,QAAI,KAAK/G,KAAL,CAAWmF,iBAAX,CAA6BC,uBAAe,CAAChH,IAA7C,CAAJ,EAAwD;EACtD,WAAK4B,KAAL,CAAWqF,oBAAX,CAAgCD,uBAAe,CAAChH,IAAhD;EACD;;EACD,SAAK+I,KAAL,GAAa,KAAb;EACA,SAAKC,aAAL,GAAqB,IAArB;EACA,SAAKpH,KAAL,CAAWwB,QAAX,CAAoBuD,KAApB;EACD;;WAED8C,eAAA,wBAAe;EACbjB,IAAAA,UAAU,CAAC5I,GAAX,CAAe,KAAK6I,GAApB,EAAyB,WAAzB,EAAsC,MAAtC;EACD;;;;;MCnJGkC;;;EACJ,sBAAYC,aAAZ,EAA2BjJ,OAA3B,EAAoCC,KAApC,EAA2C;EACzC,SAAKD,OAAL,GAAeA,OAAf;EACA,SAAKC,KAAL,GAAaA,KAAb;EACA,SAAKgJ,aAAL,GAAqBA,aAArB;EACA,SAAKlC,MAAL,GAAc/G,OAAO,CAACyF,SAAtB;EACA,SAAKyB,KAAL,GAAa,YAAb;EACA,SAAKQ,OAAL,GAAe,IAAf;EACD;;;;WAEDhG,WAAA,oBAAW;EAAA;;EACT,QAAMgG,OAAO,GAAG,SAAVA,OAAU,CAACwB,eAAD,EAAqB;EACnC,MAAA,KAAI,CAACC,WAAL,CAAiBD,eAAjB;EACD,KAFD;;EAGA,SAAKnB,SAAL,CAAeL,OAAf;;EACAnE,IAAAA,cAAM,CAACyE,gBAAP,CAAwB,KAAKd,KAA7B,EAAoC,KAAKQ,OAAzC,EAAkD,IAAlD;EACA,WAAO,CAAP;EACD;;WAEDvF,aAAA,sBAAa;EACXoB,IAAAA,cAAM,CAAC6E,mBAAP,CAA2B,KAAKlB,KAAhC,EAAuC,KAAKQ,OAA5C,EAAqD,IAArD;;EACA,SAAKK,SAAL,CAAe,IAAf;;EACA,WAAO,CAAP;EACD;EAED;;;;;;WAIAoB,cAAA,qBAAYD,eAAZ,EAA6B;EAC3B,QAAME,OAAO,GAAGJ,UAAU,CAACK,QAAX,CAAoBH,eAAe,CAACI,MAApC,CAAhB;;EACA,QAAIF,OAAO,MAAM5D,oBAAY,CAAC,KAAKuB,MAAN,EAAc,MAAd,CAAZ,IACjBrB,eAAO,CAAC,KAAKqB,MAAN,EAAc,WAAd,CADI,CAAP,IAEJ,KAAK9G,KAAL,CAAWwB,QAAX,CAAoB8H,SAApB,EAFA,EAEiC;EAC/BL,MAAAA,eAAe,CAACM,wBAAhB;;EACA,WAAKP,aAAL,CAAmBrB,MAAnB;EACD;EACF;;WAEDG,YAAA,mBAAUL,OAAV,EAAmB;EACjB,SAAKA,OAAL,GAAeA,OAAf;EACD;;eAEM2B,WAAP,kBAAgBI,GAAhB,EAAqB;EACnB,QAAI7D,IAAI,GAAG6D,GAAX;EACA,QAAMC,WAAW,GAAG9D,IAAI,CAAC+D,WAAL,CAAiB,GAAjB,CAApB;EACA/D,IAAAA,IAAI,GAAG8D,WAAW,KAAK,CAAC,CAAjB,GAAqB9D,IAAI,CAACgE,KAAL,CAAWF,WAAX,EAAwBhB,OAAxB,CAAgC,gBAAhC,CAArB,GAAyE,IAAhF;EACA,WAAO9C,IAAP;EACD;;;;;ECtDH,IAAMiE,cAAc,GAAG;EACrBC,EAAAA,IAAI,EAAE,MADe;EAErBC,EAAAA,IAAI,EAAE;EAFe,CAAvB;;MAKqBC;;;EACnB,iBAAYvI,QAAZ,EAAsB;EAAA;;EACpB,SAAKA,QAAL,GAAgBA,QAAhB,CADoB;;EAEpB,SAAKwI,mBAAL,sDACGJ,cAAc,CAACC,IADlB,IACyB,IADzB,wBAEGD,cAAc,CAACE,IAFlB,IAEyB,IAFzB;EAID;;;;WAkBDzE,uBAAA,8BAAqB4E,IAArB,EAA2B;EACzB,QAAIC,MAAM,CAACC,MAAP,CAAcP,cAAd,EAA8BQ,OAA9B,CAAsCH,IAAtC,MAAgD,CAAC,CAArD,EAAwD;EACtD,aAAO,KAAKD,mBAAL,CAAyBC,IAAzB,CAAP;EACD;;EACD,UAAM,IAAI9D,KAAJ,CAAU,oBAAV,CAAN;EACD;;WAEDhB,oBAAA,2BAAkB8E,IAAlB,EAAwB;EACtB,WAAO,OAAO,KAAKD,mBAAL,CAAyBC,IAAzB,CAAP,KAA0C,UAAjD;EACD;;;;wBAzBUzL,KAAK;EACd,UAAI,OAAOA,GAAP,KAAe,UAAnB,EAA+B;EAC7B,cAAM,IAAI6L,SAAJ,CAAc,8BAAd,CAAN;EACD;;EACD,WAAKL,mBAAL,CAAyBlM,IAAzB,GAAgCU,GAAhC;EACA,aAAO,IAAP;EACD;;;wBAEUA,KAAK;EACd,UAAI,OAAOA,GAAP,KAAe,UAAnB,EAA+B;EAC7B,cAAM,IAAI6L,SAAJ,CAAc,8BAAd,CAAN;EACD;;EACD,WAAKL,mBAAL,CAAyB5L,IAAzB,GAAgCI,GAAhC;EACA,aAAO,IAAP;EACD;;;;;;ECXH,IAAM8B,QAAQ,GAAG,UAAjB;EACA,IAAMgK,UAAU,GAAG,gBAAnB;EACA,IAAMC,UAAU,GAAG,kBAAnB;EACA,IAAMC,IAAI,GAAG,KAAb;EACA,IAAMC,GAAG,GAAGnH,cAAM,CAACkH,IAAD,CAAN,IAAgB,IAA5B;;MAEME;;;EACJ,mBAAYC,GAAZ,EAAiBC,IAAjB,EAAuB;EACrB;;;;;;;;;;;;EAYA,SAAK/M,QAAL,GAAgBqD,QAAQ,CAAC2J,aAAT,CAAuB,KAAvB,CAAhB;EACA,SAAKhN,QAAL,CAAciN,SAAd,GAA0BxK,QAA1B;EACAtC,IAAAA,WAAG,CAAC,KAAKH,QAAN,EAAgB;EACjBkN,MAAAA,UAAU,EAAE,gBADK;EAEjBC,MAAAA,MAAM,EAAE,MAFS;EAGjBxH,MAAAA,KAAK,EAAE,MAHU;EAIjBvF,MAAAA,OAAO,EAAE,MAJQ;EAKjBgN,MAAAA,QAAQ,EAAE,OALO;EAMjBC,MAAAA,GAAG,EAAE,CANY;EAOjBC,MAAAA,IAAI,EAAE;EAPW,KAAhB,CAAH;EASA,SAAKR,GAAL,GAAWA,GAAX;EACA,SAAKC,IAAL,GAAYA,IAAZ;EACA,SAAK7D,IAAL,GAAY7F,QAAQ,CAAC6F,IAArB;EACA,SAAK3F,MAAL,GAAc,IAAd;EACA,SAAKgK,YAAL,GAAoB,IAApB;EACA,SAAKrC,UAAL,GAAkB,IAAlB;EACA,SAAKsC,SAAL,GAAiB,IAAIC,uBAAJ,CAAoB,IAApB,CAAjB;EACA,SAAKvB,KAAL,GAAa,IAAIA,KAAJ,CAAU,KAAKsB,SAAf,CAAb;EACD;;;;WAqBDE,QAAA,eAAMxL,OAAN,EAAe;EACb,QAAI,CAAC,KAAK4K,GAAV,EAAe;EACb,YAAM,IAAIN,SAAJ,eACQG,IADR,mMAAN;EAKD;;EAED,QAAMgB,IAAI,GAAG,OAAOtB,MAAM,CAACuB,MAAd,KAAyB,UAAzB,GAAsCvB,MAAM,CAACuB,MAAP,CAAc,EAAd,EAAkBf,OAAO,CAACgB,aAA1B,CAAtC,gBACRhB,OAAO,CAACgB,aADA,CAAb;;EAIA,QAAI3L,OAAO,IAAI,OAAOA,OAAP,KAAmB,QAAlC,EAA4C;EAAA,iBACvBmK,MAAM,CAACyB,IAAP,CAAY5L,OAAZ,CADuB;;EAC1C,+CAAyC;EAApC,YAAM6L,IAAI,WAAV;;EACH,YAAI1B,MAAM,CAAC2B,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCP,IAArC,EAA2CI,IAA3C,CAAJ,EAAsD;EACpDJ,UAAAA,IAAI,CAACI,IAAD,CAAJ,GAAa7L,OAAO,CAAC6L,IAAD,CAApB;EACD,SAFD,MAEO;EACL;EACD;EACF;EACF;;EAED,SAAKhB,IAAL,GAAY,KAAKA,IAAL,GAAY,KAAKA,IAAjB,GAAwBY,IAAI,CAACZ,IAAzC;EAEA,QAAMoB,KAAK,GAAG,KAAKrB,GAAL,YAAoBsB,WAApB,GAAkC,KAAKtB,GAAvC,GAA6CuB,SAAC,CAAC,KAAKvB,GAAN,CAA5D;EACA,QAAMwB,MAAM,GAAG,KAAKvB,IAAL,YAAqBqB,WAArB,GAAmC,KAAKrB,IAAxC,GAA+CsB,SAAC,CAAC,KAAKtB,IAAN,CAA/D;EACA,QAAIwB,QAAQ,GAAI3G,eAAO,CAAC0G,MAAD,EAAS7B,UAAT,CAAvB;;EAEA,QAAIkB,IAAI,CAACa,WAAT,EAAsB;EACpB,UAAMC,aAAa,GAAGd,IAAI,CAAC3N,QAAL,IAAiB,KAAvC,CADoB;EAGpB;;EACA,UAAI,CAACyO,aAAL,EAAoB;EAClBH,QAAAA,MAAM,CAACI,qBAAP,CAA6B,aAA7B,EAA4C,KAAK1O,QAAjD;EACD,OAFD,MAEO,IAAI,OAAOyO,aAAP,KAAyB,QAA7B,EAAuC;EAC5C;EACA,YAAMzO,QAAQ,GAAI,MAAM6K,IAAN,CAAW4D,aAAX,IAA4BA,aAA5B,SAAgDA,aAAlE;EACA,aAAKzO,QAAL,GAAgBqO,SAAC,CAACrO,QAAD,CAAjB;EACD,OAJM,MAIA,IAAIyO,aAAa,YAAYL,WAA7B,EAA0C;EAC/C,aAAKpO,QAAL,GAAgByO,aAAhB;EACD,OAFM,MAEA;EACL,cAAM,IAAIjC,SAAJ,CAAc,uEAAd,CAAN;EACD;EACF;;EAED+B,IAAAA,QAAQ,GAAG,MAAM1D,IAAN,CAAW0D,QAAX,IAAuBA,QAAvB,GAAqCA,QAArC,OAAX;EACA,QAAMI,cAAc,GAAG;EACrBtM,MAAAA,OAAO,EAAEiM,MADY;EAErB3G,MAAAA,SAAS,EAAEwG,KAFU;EAGrB1L,MAAAA,QAAQ,EAAE,IAAI1C,QAAJ,CAAa,KAAKC,QAAlB,CAHW;EAIrBuC,MAAAA,IAAI,EAAE,KAAK2G,IAJU;EAKrB/B,MAAAA,UAAU,EAAEwG,IAAI,CAACrN,UALI;EAMrBqC,MAAAA,SAAS,EAAEG,kBAAU,CAAC6K,IAAI,CAACjL,SAAN,CANA;EAOrBuI,MAAAA,IAAI,EAAE0C,IAAI,CAAC1C;EAPU,KAAvB;;EASA,QAAM2D,aAAa,gBACdD,cADc;EAEjBE,MAAAA,SAAS,EAAEN,QAFM;EAGjB5L,MAAAA,SAAS,EAAEgL,IAAI,CAACjL,SAHC;EAIjBoM,MAAAA,YAAY,EAAEnB,IAAI,CAACmB,YAJF;EAKjBC,MAAAA,SAAS,EAAEpB,IAAI,CAACoB,SALC;EAMjBC,MAAAA,mBAAmB,EAAErB,IAAI,CAACqB,mBANT;EAOjBC,MAAAA,YAAY,EAAEtB,IAAI,CAACsB;EAPF,MAAnB;;EASA,QAAMC,WAAW,GAAG;EAClBvH,MAAAA,SAAS,EAAEgH,cAAc,CAAChH;EADR,KAApB;EAIA,WAAO,IAAIwH,cAAJ,CAAmB,IAAnB,EAAyB;EAC9BR,MAAAA,cAAc,EAAdA,cAD8B;EAE9BC,MAAAA,aAAa,EAAbA,aAF8B;EAG9BM,MAAAA,WAAW,EAAXA;EAH8B,KAAzB,CAAP;EAKD;;WAEDE,YAAA,mBAAU9K,OAAV,EAAmB;EACjBA,IAAAA,OAAO,IAAI,CAAX;;EACA,QAAIA,OAAO,GAAGuI,OAAO,CAACwC,QAAR,CAAiBC,OAA3B,IAAsC,KAAK/B,YAAL,YAA6BxE,UAAvE,EAAmF;EACjF,WAAKwE,YAAL,CAAkBlJ,UAAlB;EACD;;EACD,QAAIC,OAAO,GAAGuI,OAAO,CAACwC,QAAR,CAAiB9L,MAA3B,IAAqC,KAAKA,MAAL,YAAuBtB,SAAhE,EAA2E;EACzE,WAAKsB,MAAL,CAAYc,UAAZ;EACD;;EACD,QAAIC,OAAO,GAAGuI,OAAO,CAACwC,QAAR,CAAiBE,IAA3B,IAAmC,KAAKrE,UAAL,YAA2BA,UAAlE,EAA8E;EAC5E,WAAKA,UAAL,CAAgB7G,UAAhB;EACD;;EACD,QAAI,CAACC,OAAL,EAAc;EACZ,YAAM,IAAIgE,KAAJ,CAAU,0BAAV,CAAN;EACD;EACF;;WAEDkH,WAAA,oBAAW;EACT,WAAO9C,UAAP;EACD;;YAEM+C,YAAP,mBAAiBC,IAAjB,EAAuB;EACrBjK,IAAAA,cAAM,CAACiK,IAAD,CAAN,GAAejK,cAAM,CAACiK,IAAD,CAAN,IAAgB,EAA/B;EACAjK,IAAAA,cAAM,CAACiK,IAAD,CAAN,CAAa/C,IAAb,IAAqBE,OAArB;EACApH,IAAAA,cAAM,CAACkH,IAAD,CAAN,GAAeC,GAAf;EACD;;WAED+C,aAAA,oBAAWzN,OAAX,EAAoB;EAAA;;EAAA,QAEFqB,MAFE,GAGdrB,OAHc,CAEhB+M,YAFgB;EAIlB,SAAK1L,MAAL,GAAcA,MAAM,IAAI,OAAOA,MAAP,KAAkB,QAA5B,GAAuC,IAAIA,MAAJ,CAAWrB,OAAX,EAAoB,KAAKgK,KAAzB,CAAvC,GAAyE,IAAIjK,SAAJ,CAAcC,OAAd,EAAuB,KAAKgK,KAA5B,CAAvF;EACA,WAAO;EACLtI,MAAAA,QAAQ,EAAE;EAAA,eAAM,KAAI,CAACL,MAAL,CAAYK,QAAZ,EAAN;EAAA,OADL;EAELS,MAAAA,UAAU,EAAE;EAAA,eAAM,KAAI,CAACd,MAAL,CAAYc,UAAZ,EAAN;EAAA;EAFP,KAAP;EAID;;WAEDuL,WAAA,kBAAS1N,OAAT,EAAkB;EAAA;;EAChB,SAAKgJ,UAAL,GAAkB,IAAIA,UAAJ,CAAe,KAAKqC,YAApB,EAAkCrL,OAAlC,EAA2C,KAAKgK,KAAhD,CAAlB;EACA,WAAO;EACLtI,MAAAA,QAAQ,EAAE;EAAA,eAAM,MAAI,CAACsH,UAAL,CAAgBtH,QAAhB,EAAN;EAAA,OADL;EAELS,MAAAA,UAAU,EAAE;EAAA,eAAM,MAAI,CAAC6G,UAAL,CAAgB7G,UAAhB,EAAN;EAAA;EAFP,KAAP;EAID;;WAEDwL,cAAA,qBAAY3N,OAAZ,EAAqB;EAAA;;EACnB,SAAKqL,YAAL,GAAoB,IAAIxE,UAAJ,CAAe7G,OAAf,EAAwB,KAAKgK,KAA7B,CAApB;EACA,WAAO;EACLtI,MAAAA,QAAQ,EAAE;EAAA,eAAM,MAAI,CAAC2J,YAAL,CAAkB3J,QAAlB,EAAN;EAAA,OADL;EAELS,MAAAA,UAAU,EAAE;EAAA,eAAM,MAAI,CAACkJ,YAAL,CAAkBlJ,UAAlB,EAAN;EAAA;EAFP,KAAP;EAID;;;;;kBArLGwI,0BAmCmB;EACrBvM,EAAAA,UAAU,EAAE,GADS;EAErBoC,EAAAA,SAAS,EAAE,CAAC,CAFS;EAGrB8L,EAAAA,WAAW,EAAE,KAHQ;EAIrBxO,EAAAA,QAAQ,EAAE,IAJW;EAKrB+M,EAAAA,IAAI,EAAE,IALe;EAMrBiC,EAAAA,mBAAmB,EAAE,IANA;EAOrBF,EAAAA,YAAY,EAAE,EAPO;EAQrBC,EAAAA,SAAS,EAAE,IAAI,CARM;EASrB9D,EAAAA,IAAI,EAAE,IATe;EAUrBgE,EAAAA,YAAY,EAAE;EAVO;;kBAnCnBpC,qBAgDc;EAChByC,EAAAA,OAAO,EAAE,IADO;EAEhB/L,EAAAA,MAAM,EAAE,IAFQ;EAGhBuM,EAAAA,GAAG,EAAE;EAHW;;MAwIdX;;;EACJ,0BAAYY,eAAZ,EAA6B7N,OAA7B,EAAsC;EACpC,SAAK8N,KAAL,GAAaD,eAAb;EACA,SAAK7N,OAAL,GAAeA,OAAf;EACD;;;;YAED+N,QAAA,iBAAQ;EAAA;;EACN,QAAMC,cAAc,GAAG,CAAC,KAAKF,KAAL,CAAWH,WAAX,CAAuB,KAAK3N,OAAL,CAAayM,cAApC,EAAoD/K,QAApD,EAAxB;EACA,QAAMuM,aAAa,GAAG,CAAC,KAAKH,KAAL,CAAWL,UAAX,CAAsB,KAAKzN,OAAL,CAAa0M,aAAnC,EAAkDhL,QAAlD,EAAvB;EACA,QAAMwM,WAAW,GAAG,CAAC,KAAKJ,KAAL,CAAWJ,QAAX,CAAoB,KAAK1N,OAAL,CAAagN,WAAjC,EAA8CtL,QAA9C,EAArB;EACA,WAAO,IAAIyM,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;EACtC,UAAI,EAAEL,cAAc,IAAIC,aAAlB,IAAmCC,WAArC,CAAJ,EAAuD;EACrDG,QAAAA,MAAM,CAAC,IAAIjI,KAAJ,CAAU,yCAAV,CAAD,CAAN;EACA;EACD;;EACDgI,MAAAA,OAAO,CAAC,IAAIE,aAAJ,CAAkB,MAAI,CAACR,KAAvB,EAA8B,MAAI,CAACA,KAAL,CAAW9D,KAAzC,CAAD,CAAP;EACD,KANM,CAAP;EAOD;;YAEDuE,UAAA,mBAAU;EACR,SAAKT,KAAL,CAAWzC,YAAX,CAAwBlD,eAAxB;EACA,SAAK2F,KAAL,CAAWzM,MAAX,CAAkBc,UAAlB;EACA,SAAK2L,KAAL,CAAW9E,UAAX,CAAsB7G,UAAtB;EACD;;YAEDmL,WAAA,oBAAW;EACT,WAAO,yBAAP;EACD;;;;;MAGGgB;;;EAEJ,yBAAYR,KAAZ,EAAmB7N,KAAnB,EAA0B;EAAA,oCADjB,CAACoF,uBAAe,CAACtH,IAAjB,EAAuBsH,uBAAe,CAAChH,IAAvC,CACiB;;EACxB,SAAKyP,KAAL,GAAaA,KAAb;EACA,SAAKU,MAAL,GAAcvO,KAAd;EACD;;;;YACD0B,KAAA,YAAGuF,KAAH,EAAUuH,MAAV,EAAgC;EAAA,QAAtBA,MAAsB;EAAtBA,MAAAA,MAAsB,GAAb;EAAA,eAAM,KAAN;EAAA,OAAa;EAAA;;EAC9B,QAAI,EAAE,KAAKC,MAAL,CAAYrE,OAAZ,CAAoBnD,KAApB,IAA6B,CAA/B,CAAJ,EAAuC;EACrC,YAAM,IAAId,KAAJ,qBAA4Bc,KAA5B,OAAN;EACD;;EACD,SAAKsH,MAAL,QAAiBtH,KAAjB,IAA4BuH,MAAM,CAACE,IAAP,CAAY,KAAKb,KAAjB,CAA5B;EACD;;YACDc,MAAA,aAAI1H,KAAJ,EAAW;EACT,QAAI,EAAE,KAAKwH,MAAL,CAAYrE,OAAZ,CAAoBnD,KAApB,IAA6B,CAA/B,CAAJ,EAAuC;EACrC,YAAM,IAAId,KAAJ,qBAA4Bc,KAA5B,OAAN;EACD;;EACD,SAAKsH,MAAL,QAAiBtH,KAAjB,IAA4B,IAA5B;EACD;;;;;;;;;;;"}