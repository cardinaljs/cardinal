!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).Cardinal=e()}(this,function(){"use strict";function s(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function i(t,e,i){return e&&s(t.prototype,e),i&&s(t,i),t}function t(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function y(){return(y=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t}).apply(this,arguments)}function r(t,e){t.prototype=Object.create(e.prototype),(t.prototype.constructor=t).__proto__=e}var o=360,n=Math.PI,h=n/180,a=1/h,c=90,l=180,u=270,d=360,e=function(s){function t(t,e){var i;return(i=s.call(this,t)||this)._angles=e,i.angles=e.map(function(t){return h*t}),i._quad=null,i}r(t,s);var e=t.prototype;return e._degToRad=function(t){return h*t},e._radToDeg=function(t){return a*t},e._findOppUseSOH=function(t,e){return Math.sin(t)*e},e._firstPath=function(){var n=this,r=[];return this._angles.forEach(function(t){if(0===t||t<=o&&t%90==0)r.push(n.radius);else{n._quad=n._getQuadrant(t),t=n._quad!==c?n._quad-t:t;var e=n._degToRad(t),i=n._chordLength(e),s=90-n._getLastTwoEqAngles(e);r.push(n._findOppUseSOH(n._degToRad(s),i))}}),r},e._resolvePath=function(t,e){var n=this,r=[];return this._angles.forEach(function(t){if(0===t||t<=o&&t%90==0)r.push(n.radius);else{n._quad=n._getQuadrant(t),t=n._quad!==c?n._quad-t:t;var e=n._degToRad(t),i=n._chordLength(e),s=90-n._getLastTwoEqAngles(e);r.push(n._findOppUseSOH(n._degToRad(s),i))}}),r},e._getLastTwoEqAngles=function(t){return.5*(180-this._radToDeg(t))},e._getQuadrant=function(t){if(t<=c)return c;if(t<=l&&c<t)return l;if(t<=u&&l<t)return u;if(t<=d&&u<t)return d;throw RangeError("Quadrant out of range")},e._chordLength=function(t){var e=Math.pow(this.radius,2),i=2*e-2*e*Math.cos(t);return i=Math.sqrt(i)},i(t,[{key:"path",get:function(){}}]),t}(function(){function t(t){this.radius=t,this.diameter=2*this.radius}var e=t.prototype;return e.areaOfSect=function(t){return(t*=h)/o*this.area},e.lenOfSect=function(t){return(t*=h)/o*this.circumference},i(t,[{key:"area",get:function(){return n*Math.pow(this.radius,2)}},{key:"circumference",get:function(){return 2*n*this.radius}}]),t}()),p="0.7rem 0 rgba(0,0,0,.3)",f={top:"0 0.2rem "+p,left:"0.2rem 0 "+p,bottom:"0 -0.2rem "+p,right:"-0.2rem 0 "+p},X=["top","left","bottom","right"],v=function(){function t(t,e){this.lower=t,this.upper=e}return i(t,[{key:"gap",get:function(){return this.upper-this.lower}},{key:"slack",get:function(){return this.lower-this.upper}}]),t}();function g(t){return function(t,e){void 0===e&&(e="-");return(t instanceof Array?t:t.split(e)).reduce(function(t,e){return t+e.charAt(0).toUpperCase()+e.slice(1)})}(t.substring(5),"-")}function Y(t){return document.querySelectorAll(t)[0]}function k(t,e){return t.getAttribute(e)}function E(t,e){var i=g(e);return t.dataset&&t.dataset[i]?t.dataset[i]:k(t,e)}function _(t){return t<1&&0<t?t=1-t:t<0?t=1:1}function w(){if(arguments.length<1)return null;var t=arguments.length<=0?void 0:arguments[0],e=arguments.length<=1?void 0:arguments[1],i=arguments.length<=2?void 0:arguments[2],s=window.getComputedStyle(t);if("string"==typeof e&&i)return t.style[e]=i,null;if(!("object"==typeof e&&e instanceof Object)){if(e instanceof Array){var n={},r=s,o=Array.isArray(r),h=0;for(r=o?r:r[Symbol.iterator]();;){var a;if(o){if(h>=r.length)break;a=r[h++]}else{if((h=r.next()).done)break;a=h.value}var c=a;n[c]=s[c]}return n}return s[e]}i=e;for(var l=Object.keys(i),u=0;u<l.length;u++){var d=l[u];t.style[d]=i[d]}return s}var b=function(n){function t(t,e,i,s){return n.call(this,t,e,i,s)||this}return r(t,n),i(t,[{key:"width",get:function(){return Math.abs(this.displacementX)}},{key:"height",get:function(){return Math.abs(this.displacementY)}},{key:"greaterWidth",get:function(){return this.width>this.height}},{key:"greaterHeight",get:function(){return!this.greaterWidth}}]),t}(function(){function t(t,e,i,s){this.coordsX={x1:t,x2:i},this.coordsY={y1:e,y2:s}}return i(t,[{key:"displacementX",get:function(){return this.coordsX.x2-this.coordsX.x1}},{key:"displacementY",get:function(){return this.coordsY.y2-this.coordsY.y1}},{key:"diagonalLength",get:function(){return this.displacementY?this.displacementX?Math.sqrt(Math.pow(this.displacementY,2)+Math.pow(this.displacementX,2)):this.displacementY:this.displacementX}}]),t}()),S="bottom",T="dimension",C="event",I="threshold",O="belowthreshold",x="open",A="close",m=function(){function m(t,e){this.options=t,this.bound=e,this.element=t.ELEMENT,this._winSize=this.options.sizeOfWindow||m._windowSize,this.winSize=this._winSize(),this.height=this.options.SIZE,this.unit=this.options.unit||"px",this.minArea=this.winSize-(this.bound.lower||this.options.maxStartArea||25),this.threshold=this.options.threshold||.667,this.threshold=_(this.threshold),this.startX=-1,this.startY=-1,this.resumeX=-1,this.resumeY=-1,this.endX=-1,this.endY=-1,this.scrollControlSet=!1,this.scrollControl=null,this.timing={start:null,end:null},this._context=this}var t=m.prototype;return t.start=function(t,e){this.timing.start=new Date,this._updateOrientation();var i=this.winSize,s=t.changedTouches[0].pageY||t.changedTouches[0].clientY;this.startX=t.changedTouches[0].pageX||t.changedTouches[0].clientX,this.startY=s;var n=parseFloat(m._getStyle(this.element)[S].replace(/[^\d]*$/,"")),r=this.bound;this.positionOnStart=n;var o=r.lower?"-"+(r.upper-(i-r.lower))+this.unit:"-"+(r.upper-(i-s))+this.unit,h="-"+(r.upper-(i-2))+this.unit;if(s<=i&&s>=this.minArea&&0!==n){var a,c=((a={})[C]=t,a[T]=o,a.displacement=h,a);e.call(this._context,c,new b(this.startX,this.startY,-1,-1))}},t.move=function(t,e){var i=this.winSize,s=i-this.bound.upper,n=t.changedTouches[0].pageY||t.changedTouches[0].clientY;this.resumeX=t.changedTouches[0].pageX||t.changedTouches[0].clientX,this.resumeY=n;var r=parseFloat(m._getStyle(this.element)[S].replace(/[^\d]*$/,"")),o=this.bound,h=0===this.positionOnStart?A:x,a=this.startY,c=o.upper||this.height,l=a<s?s:a,u="-"+(c-(i-n))+this.unit,d="-"+(n-l)+this.unit,p=new b(this.startX,this.startY,this.resumeX,this.resumeY),f=p.greaterHeight;if(this.scrollControlSet||(this.scrollControl=f,this.scrollControlSet=!this.scrollControlSet),a<=i&&(a>=this.minArea||s+r<=a)&&0!==r&&f&&h==x&&this.scrollControl&&p.displacementY<0){var v,g=((v={})[C]=t,v[T]=u,v.open=!0,v.close=!1,v);e.call(this._context,g,p)}if(s<=n&&Math.abs(r)<c-o.lower&&f&&h==A&&this.scrollControl&&0<p.displacementY){var _,w=((_={})[C]=t,_[T]=d,_.close=!0,_.open=!1,_);e.call(this._context,w,p)}},t.end=function(t,e,i){var s;this.timing.end=new Date;var n=this.winSize-this.bound.upper,r=t.changedTouches[0].pageY||t.changedTouches[0].clientY;this.endX=t.changedTouches[0].pageX||t.changedTouches[0].clientX,this.endY=r;var o=new b(this.startX,this.startY,this.endX,this.endY),h=this.startY,a=this.timing.end.getTime()-this.timing.start.getTime(),c=this.threshold,l=parseFloat(m._getStyle(this.element)[S].replace(/[^\d]*$/,"")),u=""+this.bound.slack+this.unit,d="0",p=Math.abs(l),f=x;this.scrollControl=this.scrollControlSet=!1;var v=((s={})[C]=t,s.position=l,s.rect=o,s);function g(t,e){var i,s,n="oppositeDimension";return t===I&&e||t===O&&!e?y(((i={})[T]=d,i.TIMING=a,i[n]=u,i),v):t===I&&!e||t===O&&e?y(((s={})[T]=u,s.TIMING=a,s[n]=d,s),v):{}}if(o.displacementY<0&&(h>=this.minArea||n+l<=h))return p<=this.height*c?i.state=[I,A]:i.state=[O,A],i.stateObj=g(i.state[0],!0),void e.call(this,f);0<o.displacementY&&this.resumeY>=n&&(f=A,p>=this.height*c?i.state=[I,x]:i.state=[O,x],i.stateObj=g(i.state[0],!1),e.call(this,f))},t.setContext=function(t){return this._context=t,this},m._getStyle=function(t,e){return e?window.getComputedStyle(t,e):window.getComputedStyle(t)},m._windowSize=function(){return window.screen.availHeight},t._updateOrientation=function(){this.winSize="function"==typeof this._winSize?this._winSize():m._windowSize(),this.minArea=this.winSize-(this.bound.lower||this.options.maxStartArea||25)},m}(),N="left",D="dimension",M="event",H="threshold",z="belowthreshold",L="open",R="close",j=function(){function w(t,e){this.options=t,this.bound=e,this.element=t.ELEMENT,this._winSize=this.options.sizeOfWindow||w._windowSize,this.winSize=this._winSize(),this.width=this.options.SIZE,this.unit=this.options.unit||"px",this.maxArea=this.bound.lower||this.options.maxStartArea||25,this.threshold=this.options.threshold||.667,this.threshold=_(this.threshold),this.startX=-1,this.startY=-1,this.resumeX=-1,this.resumeY=-1,this.endX=-1,this.endY=-1,this.scrollControlSet=!1,this.scrollControl=null,this.timing={start:null,end:null},this._context=this}var t=w.prototype;return t.start=function(t,e){this.timing.start=new Date;var i=t.changedTouches[0].pageX||t.changedTouches[0].clientX;this.startX=i,this.startY=t.changedTouches[0].pageY||t.changedTouches[0].clientY;var s=parseFloat(w._getStyle(this.element)[N].replace(/[^\d]*$/,"")),n=this.bound;this.positionOnStart=s;var r=n.lower?"-"+(n.upper-n.lower)+this.unit:"-"+(n.upper-i)+this.unit,o="-"+(n.upper-2)+this.unit;if(0<=i&&i<=this.maxArea&&0!==s){var h,a=((h={})[M]=t,h[D]=r,h.displacement=o,h);e.call(this._context,a,new b(this.startX,this.startY,-1,-1))}},t.move=function(t,e){var i=t.changedTouches[0].pageX||t.changedTouches[0].clientX;this.resumeX=i,this.resumeY=t.changedTouches[0].pageY||t.changedTouches[0].clientY;var s=parseFloat(w._getStyle(this.element)[N].replace(/[^\d]*$/,"")),n=this.bound,r=0===this.positionOnStart?R:L,o=this.startX,h=n.upper||this.width,a=h<o?h:o,c="-"+(h-i)+this.unit,l="-"+(a-i)+this.unit,u=new b(this.startX,this.startY,this.resumeX,this.resumeY),d=u.greaterWidth;if(this.scrollControlSet||(this.scrollControl=d,this.scrollControlSet=!this.scrollControlSet),0<=o&&(o<=this.maxArea||o<=h+s)&&0!==s&&d&&r==L&&this.scrollControl&&0<u.displacementX){var p,f=((p={})[M]=t,p[D]=c,p.open=!0,p.close=!1,p);e.call(this._context,f,u)}if(i<=h&&Math.abs(s)<h-n.lower&&d&&r==R&&this.scrollControl&&u.displacementX<0){var v,g=((v={})[M]=t,v[D]=l,v.close=!0,v.open=!1,v);e.call(this._context,g,u)}},t.end=function(t,e,i){var s;this.timing.end=new Date;var n=t.changedTouches[0].pageX||t.changedTouches[0].clientX;this.endX=n,this.endY=t.changedTouches[0].pageY||t.changedTouches[0].clientY;var r=new b(this.startX,this.startY,this.endX,this.endY),o=this.startX,h=this.timing.end.getTime()-this.timing.start.getTime(),a=this.threshold,c=parseFloat(w._getStyle(this.element)[N].replace(/[^\d]*$/,"")),l=this.bound,u=""+l.slack+this.unit,d="0",p=l.upper||this.width,f=Math.abs(c),v=L;this.scrollControl=this.scrollControlSet=!1;var g=((s={})[M]=t,s.position=c,s.rect=r,s);function _(t,e){var i,s,n="oppositeDimension";return t===H&&e||t===z&&!e?y(((i={})[D]=d,i.TIMING=h,i[n]=u,i),g):t===H&&!e||t===z&&e?y(((s={})[D]=u,s.TIMING=h,s[n]=d,s),g):{}}if(0<r.displacementX&&(o<=this.maxArea||o<=p+c))return f<=this.width*a?i.state=[H,R]:i.state=[z,R],i.stateObj=_(i.state[0],!0),void e.call(this,v);r.displacementX<0&&this.resumeX<=this.width&&(v=R,f>=this.width*a?i.state=[H,L]:i.state=[z,L],i.stateObj=_(i.state[0],!1),e.call(this,v)),this.startX=-1,this.startY=-1,this.resumeX=-1,this.resumeY=-1,this.endX=-1,this.endY=-1},t.setContext=function(t){return this._context=t,this},w._getStyle=function(t,e){return e?window.getComputedStyle(t,e):window.getComputedStyle(t)},w._windowSize=function(){return window.screen.availWidth},w}(),P="right",W="dimension",G="event",F="threshold",$="belowthreshold",q="open",U="close",B=function(){function m(t,e){this.options=t,this.bound=e,this.element=t.ELEMENT,this._winSize=this.options.sizeOfWindow||m._windowSize,this.winSize=this._winSize(),this.width=this.options.SIZE,this.unit=this.options.unit||"px",this.minArea=this.winSize-(this.bound.lower||this.options.maxStartArea||25),this.threshold=this.options.threshold||.667,this.threshold=_(this.threshold),this.startX=-1,this.startY=-1,this.resumeX=-1,this.resumeY=-1,this.endX=-1,this.endY=-1,this.scrollControlSet=!1,this.scrollControl=null,this.timing={start:null,end:null},this._context=this}var t=m.prototype;return t.start=function(t,e){this.timing.start=new Date,this._updateOrientation();var i=this.winSize,s=t.changedTouches[0].pageX||t.changedTouches[0].clientX;this.startX=s,this.startY=t.changedTouches[0].pageY||t.changedTouches[0].clientY;var n=parseFloat(m._getStyle(this.element)[P].replace(/[^\d]*$/,"")),r=this.bound;this.positionOnStart=n;var o=r.lower?"-"+(r.upper-(i-r.lower))+this.unit:"-"+(r.upper-(i-s))+this.unit,h="-"+(r.upper-(i-2))+this.unit;if(s<=i&&s>=this.minArea&&0!==n){var a,c=((a={})[G]=t,a[W]=o,a.displacement=h,a);e.call(this._context,c,new b(this.startX,this.startY,-1,-1))}},t.move=function(t,e){var i=this.winSize,s=i-this.bound.upper,n=t.changedTouches[0].pageX||t.changedTouches[0].clientX;this.resumeX=n,this.resumeY=t.changedTouches[0].pageY||t.changedTouches[0].clientY;var r=parseFloat(m._getStyle(this.element)[P].replace(/[^\d]*$/,"")),o=this.bound,h=0===this.positionOnStart?U:q,a=this.startX,c=o.upper||this.width,l=a<s?s:a,u="-"+(c-(i-n))+this.unit,d="-"+(n-l)+this.unit,p=new b(this.startX,this.startY,this.resumeX,this.resumeY),f=p.greaterWidth;if(this.scrollControlSet||(this.scrollControl=f,this.scrollControlSet=!this.scrollControlSet),a<=i&&(a>=this.minArea||s+r<=a)&&0!==r&&f&&h==q&&this.scrollControl&&p.displacementX<0){var v,g=((v={})[G]=t,v[W]=u,v.open=!0,v.close=!1,v);e.call(this._context,g,p)}if(s<=n&&Math.abs(r)<c-o.lower&&f&&h==U&&this.scrollControl&&0<p.displacementX){var _,w=((_={})[G]=t,_[W]=d,_.close=!0,_.open=!1,_);e.call(this._context,w,p)}},t.end=function(t,e,i){var s;this.timing.end=new Date;var n=this.winSize-this.bound.upper,r=t.changedTouches[0].pageX||t.changedTouches[0].clientX;this.endX=r,this.endY=t.changedTouches[0].pageY||t.changedTouches[0].clientY;var o=new b(this.startX,this.startY,this.endX,this.endY),h=this.startX,a=this.timing.end.getTime()-this.timing.start.getTime(),c=this.threshold,l=parseFloat(m._getStyle(this.element)[P].replace(/[^\d]*$/,"")),u=""+this.bound.slack+this.unit,d="0",p=Math.abs(l),f=q;this.scrollControl=this.scrollControlSet=!1;var v=((s={})[G]=t,s.position=l,s.rect=o,s);function g(t,e){var i,s,n="oppositeDimension";return t===F&&e||t===$&&!e?y(((i={})[W]=d,i.TIMING=a,i[n]=u,i),v):t===F&&!e||t===$&&e?y(((s={})[W]=u,s.TIMING=a,s[n]=d,s),v):{}}if(o.displacementX<0&&(h>=this.minArea||n+l<=h))return p<=this.width*c?i.state=[F,U]:i.state=[$,U],i.stateObj=g(i.state[0],!0),void e.call(this,f);0<o.displacementX&&this.resumeX>=n&&(f=U,p>=this.width*c?i.state=[F,q]:i.state=[$,q],i.stateObj=g(i.state[0],!1),e.call(this,f))},t.setContext=function(t){return this._context=t,this},m._getStyle=function(t,e){return e?window.getComputedStyle(t,e):window.getComputedStyle(t)},m._windowSize=function(){return window.screen.availWidth},t._updateOrientation=function(){this.winSize="function"==typeof this._winSize?this._winSize():m._windowSize(),this.minArea=this.winSize-(this.bound.lower||this.options.maxStartArea||25)},m}(),V="dimension",Z="event",Q="threshold",K="belowthreshold",J="open",tt="close",et=function(){function w(t,e){this.options=t,this.bound=e,this.element=t.ELEMENT,this._winSize=this.options.sizeOfWindow||w._windowSize,this.winSize=this._winSize(),this.height=this.options.SIZE,this.unit=this.options.unit||"px",this.maxArea=this.bound.lower||this.options.maxStartArea||25,this.threshold=this.options.threshold||.667,this.threshold=_(this.threshold),this.startX=-1,this.startY=-1,this.resumeX=-1,this.resumeY=-1,this.endX=-1,this.endY=-1,this.scrollControlSet=!1,this.scrollControl=null,this.timing={start:null,end:null},this._context=this}var t=w.prototype;return t.start=function(t,e){this.timing.start=new Date;var i=t.changedTouches[0].pageY||t.changedTouches[0].clientY;this.startX=t.changedTouches[0].pageX||t.changedTouches[0].clientX,this.startY=i;var s=parseFloat(w._getStyle(this.element).top.replace(/[^\d]*$/,"")),n=this.bound;this.positionOnStart=s;var r=n.lower?"-"+(n.upper-n.lower)+this.unit:"-"+(n.upper-i)+this.unit,o="-"+(n.upper-2)+this.unit;if(0<=i&&i<=this.maxArea&&0!==s){var h,a=((h={})[Z]=t,h[V]=r,h.displacement=o,h);e.call(this._context,a,new b(this.startX,this.startY,-1,-1))}},t.move=function(t,e){var i=t.changedTouches[0].pageY||t.changedTouches[0].clientY;this.resumeX=t.changedTouches[0].pageX||t.changedTouches[0].clientX,this.resumeY=i;var s=parseFloat(w._getStyle(this.element).top.replace(/[^\d]*$/,"")),n=this.bound,r=0===this.positionOnStart?tt:J,o=this.startX,h=n.upper||this.height,a=h<o?h:o,c="-"+(h-i)+this.unit,l="-"+(a-i)+this.unit,u=new b(this.startX,this.startY,this.resumeX,this.resumeY),d=u.greaterHeight;if(this.scrollControlSet||(this.scrollControl=d,this.scrollControlSet=!this.scrollControlSet),0<=o&&(o<=this.maxArea||o<=h+s)&&0!==s&&d&&r==J&&this.scrollControl&&0<u.displacementY){var p,f=((p={})[Z]=t,p[V]=c,p.open=!0,p.close=!1,p);e.call(this._context,f,u)}if(i<=this.height&&Math.abs(s)<h-n.lower&&d&&r==tt&&this.scrollControl&&u.displacementY<0){var v,g=((v={})[Z]=t,v[V]=l,v.close=!0,v.open=!1,v);e.call(this._context,g,u)}},t.end=function(t,e,i){var s;this.timing.end=new Date;var n=t.changedTouches[0].pageY||t.changedTouches[0].clientY;this.endX=t.changedTouches[0].pageX||t.changedTouches[0].clientX,this.endY=n;var r=new b(this.startX,this.startY,this.endX,this.endY),o=this.startY,h=this.timing.end.getTime()-this.timing.start.getTime(),a=this.threshold,c=parseFloat(w._getStyle(this.element).top.replace(/[^\d]*$/,"")),l=this.bound,u=""+l.slack+this.unit,d="0",p=l.upper||this.height,f=Math.abs(c),v=J;this.scrollControl=this.scrollControlSet=!1;var g=((s={})[Z]=t,s.position=c,s.rect=r,s);function _(t,e){var i,s,n="oppositeDimension";return t===Q&&e||t===K&&!e?y(((i={})[V]=d,i.TIMING=h,i[n]=u,i),g):t===Q&&!e||t===K&&e?y(((s={})[V]=u,s.TIMING=h,s[n]=d,s),g):{}}if(0<r.displacementY&&(o<=this.maxArea||o<=p+c))return f<=this.height*a?i.state=[Q,tt]:i.state=[K,tt],i.stateObj=_(i.state[0],!0),void e.call(this,v);r.displacementY<0&&this.resumeY<=this.height&&(v=tt,f>=this.height*a?i.state=[Q,J]:i.state=[K,J],i.stateObj=_(i.state[0],!1),e.call(this,v))},t.setContext=function(t){return this._context=t,this},w._getStyle=function(t,e){return e?window.getComputedStyle(t,e):window.getComputedStyle(t)},w._windowSize=function(){return window.screen.availHeight},w}(),it=function(){function i(t,e){this._options=t,this._element=t.ELEMENT,this._target=t.TARGET,this.events=["touchstart","touchmove","touchend"],this._handlers=null,this._direction=t.DIRECTION,this._callibration=null,this._callbacks=null,(this._context=this)._setCalibration(this._direction,e)}var t=i.prototype;return t.activate=function(){var i=this,e=this._callbacks?this._callbacks.start:st,s=this._callbacks?this._callbacks.move:st,n=this._callbacks?this._callbacks.end:st;this._register(function(t){null!==i._direction?i._callibration.start(t,e):i.deactivate()},function(t){null!==i._direction?i._callibration.move(t,s):i.deactivate()},function(t){if(null!==i._direction){var e={};i._callibration.end(t,n,e),i._processThresholdState(e)}else i.deactivate()});for(var t=0;t<this.events.length;t++)this._target.addEventListener(this.events[t],this._handlers[t])},t.deactivate=function(){for(var t=0;t<this.events.length;t++)this._target.removeEventListener(this.events[t],this._handlers[t]);this._register(null)},t.on=function(t,e){return this._registerCallbacks(t,e),this},t.setContext=function(t){return this._context=t,this._callibration.setContext(t),this},t.toString=function(){return"[object SnappedDrawer]"},t._processThresholdState=function(t){if(!(Object.keys(t).length<1)){var e=t.state[0],i=t.stateObj.rect;delete t.stateObj.rect,this._callbacks[e].call(this._context,t.state,t.stateObj,i)}},t._setCalibration=function(t,e){switch(t){case i.UP:this._callibration=new et(this._options,e);break;case i.LEFT:this._callibration=new j(this._options,e);break;case i.DOWN:this._callibration=new m(this._options,e);break;case i.RIGHT:this._callibration=new B(this._options,e);break;default:throw RangeError("Direction out of range")}},t._registerCallbacks=function(t,e){var i;this._callbacks=this._callbacks||((i={}).start=st,i.move=st,i.end=st,i.threshold=st,i.belowthreshold=st,i),t in this._callbacks&&(this._callbacks[t]=e)},t._register=function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];this._handlers=e},i}();function st(){return!1}t(it,"UP",0),t(it,"LEFT",1),t(it,"DOWN",2),t(it,"RIGHT",3);function nt(){}t(nt,"SnappedDrawer",it),t(nt,"UP",it.UP),t(nt,"LEFT",it.LEFT),t(nt,"DOWN",it.DOWN),t(nt,"RIGHT",it.RIGHT);var rt=function(){function t(t){this.backdrop=t}var e=t.prototype;return e.show=function(t){w(this.backdrop,{display:"block",opacity:1,transition:"opacity linear "+t/1e3+"s"})},e.hide=function(t){var e=this;w(this.backdrop,{opacity:0,transition:"opacity linear "+t/1e3+"s"}),window.setTimeout(function(){w(e.backdrop,{display:"none"})},t)},e.setOpacity=function(t){w(this.backdrop,{display:"block",opacity:t,transition:"none"})},t}(),ot={navstate:null},ht=function(){function e(t,e){this.options=e,this.parentService=t,this.button=e.INIT_ELEM,this.event="hashchange",this.handler=null}var t=e.prototype;return t.activate=function(){var e=this;return this._register(function(t){e._hashchange(t)}),window.addEventListener(this.event,this.handler),0},t.deactivate=function(){return window.removeEventListener(this.event,this.handler),this._register(null),0},t._hashchange=function(t){e._getHash(t.oldURL)===k(this.button,"href")&&ot.navstate&&ot.navstate.alive&&this.parentService._close()},t._register=function(t){this.handler=t},e._getHash=function(t){var e=t,i=e.lastIndexOf("#");return e=-1!==i?e.slice(i).replace(/(?:[^\w\d-]+)$/):null},e}(),at="transition",ct="overflow",lt="hidden",ut="scroll",dt="threshold",pt=function(){function t(t){this.options=t,this.element=this.options.ELEMENT,this._body=this.options.BODY,this._backdrop=this.options.BACKDROP,this.direction=this.options.DIRECTION,this._checkDirection(),this.directionString=X[this.direction],this.bound=this._bound;var e=y({},t,{SIZE:this.elementSize,TARGET:document});this.drawer=new nt.SnappedDrawer(e,this.bound),this.transition=this.directionString+" linear 0.1s"}var e=t.prototype;return e.activate=function(){return this.drawer.on("start",this._startHandler).on("move",this._moveHandler).on(dt,this._threshold).on("belowthreshold",this._belowThreshold).setContext(this).activate(),0},e.deactivate=function(){return this.drawer.deactivate(),0},e._startHandler=function(t){var e;w(this.element,((e={})[this.directionString]=t.dimension,e.boxShadow=f[this.directionString],e[at]=this.transition,e)),this._body.style.overflow=lt},e._moveHandler=function(t,e){var i,s=this.direction===nt.UP||this.direction===nt.DOWN?e.coordsY.y2:e.coordsX.x2;if(w(this.element,((i={})[this.directionString]=t.dimension,i[at]="none",i[ct]=lt,i)),this.direction===nt.RIGHT)return s=window.screen.availWidth-s,void this._backdrop.setOpacity(s/this.elementSize);this._backdrop.setOpacity(s/this.elementSize)},e._threshold=function(t,e){var i="open"===t[1],s={stateObj:e,transition:this.directionString+" ease "+this._calcSpeed(e.TIMING)/1e3+"s"};i?this._hide(s):this._show(s)},e._belowThreshold=function(t,e,i){var s,n="open"!==t[1],r=e.TIMING,o=this.direction===nt.UP||this.direction===nt.DOWN?i.displacementY:i.displacementX,h={stateObj:e,transition:this.directionString+" ease "+this._calcSpeed(e.TIMING)/1e3+"s"};if(s=this.direction===nt.LEFT&&n||this.direction===nt.RIGHT&&!n?0<o&&10<=o&&i.greaterWidth:o<0&&o<=-10&&i.greaterWidth,r/1e3<.5)if(s)this._overrideBelowThresh(!n,h);else{if(n)return void this._hide(h);this._show(h)}else{if(n)return void this._hide(h);this._show(h)}},e._show=function(t){this._showPrep(t),this.element.style[this.directionString]=t.stateObj.dimension},e._hide=function(t){this._hidePrep(t),this.element.style[this.directionString]=t.stateObj.dimension},e._overrideBelowThresh=function(t,e){t?this._hidePrep(e):this._showPrep(e),this.element.style[this.directionString]=e.stateObj.oppositeDimension},e._hidePrep=function(t){var e;this._body.style.overflow=ut,this._backdrop.hide(this.options.TRANSITION),w(this.element,((e={})[at]=t.transition,e[ct]=ut,e)),this.bound.lower||(this.element.style.boxShadow="none"),this._setState("open")},e._showPrep=function(t){var e;window.location.hash=k(this.options.INIT_ELEM,"href")||E(this.options.INIT_ELEM,"data-href"),this._body.style.overflow=lt,this._backdrop.show(this.options.TRANSITION),w(this.element,((e={})[at]=t.transition,e[ct]=ut,e)),this._setState("open")},e._calcSpeed=function(t){if(1e3<=t)return 500;return t/1e3*100/100*500},e._checkDirection=function(){if(this.direction!==nt.LEFT&&this.direction!==nt.RIGHT)throw RangeError("Direction out of range")},e._setState=function(t){switch(t){case"open":ot.navstate={alive:!0,activity:{service:this,action:t}};break;case"close":ot.navstate={alive:!1,activity:{service:this,action:t}};break;default:throw new Error("this should never happen")}},i(t,[{key:"elementSize",get:function(){var t=this.direction;return t===nt.UP||t===nt.DOWN?this.element.offsetHeight:this.element.offsetWidth}},{key:"_bound",get:function(){var t=w(this.element,this.directionString).replace(/[^\d]*$/,""),e=this.elementSize,i=e+parseInt(t,10);return new v(i,e)}}]),t}(),ft="transition",vt="transitionend",gt=function(){function s(t){this.options=t,this.nav=t.ELEMENT,this.button=t.INIT_ELEM,this.backdrop=t.BACKDROP,this.backdropElement=this.backdrop.backdrop,this.event="click",this.direction=t.DIRECTION,this.width=this.nav.offsetWidth,this.transTime=t.TRANSITION/1e3,this.transition=this.direction+" ease "+this.transTime+"s",this.alive=!1,this._closeClicked=!1,this._initialState=s.css(this.nav,this.direction),this._handlers=null}var t=s.prototype;return t.activate=function(){var e=this;return this._register({ClickHandler:function(t){e.handler(t)},BackdropHandler:function(){e._close()},TransitionHandler:function(){!e.alive&&e._closeClicked&&(e._cleanShadow(),e._closeClicked=!1)}}),this.button.addEventListener(this.event,this._handlers.ClickHandler),this.backdropElement.addEventListener(this.event,this._handlers.BackdropHandler),this._initialState==="-"+this._width("px")&&this.nav.addEventListener(vt,this._handlers.TransitionHandler),0},t.deactivate=function(){throw new ReferenceError("cannot deactivate API specified as default. This service must be kept running")},t.forceDeactivate=function(){this.button.removeEventListener(this.event,this._handlers.ClickHandler),this.backdropElement.removeEventListener(this.event,this._handlers.BackdropHandler),this._initialState==="-"+this._width("px")&&this.nav.removeEventListener(vt,this._handlers.TransitionHandler),this._register(null)},t.handler=function(t){t.preventDefault(),window.location.hash=k(this.button,"href"),s._toNum(s.css(this.nav,this.direction))<0?this._open():this._close()},s.css=function(t,e,i){return w(t,e,i)},s._toNum=function(t){return t=t.replace(/[^\d]*$/,""),/\.(?=\d)/.test(t)?Math.round(parseFloat(t)):parseInt(t,10)},t._width=function(t){return t=t||"",this.width+t},t._register=function(t){this._handlers=t},t._open=function(){var t,e=((t={})[this.direction]=0,t[ft]=this.transition,t.boxShadow=f[this.direction],t);s.css(this.nav,e),this.backdrop.show(this.options.TRANSITION),this.alive=!0;var i={alive:this.alive,activity:{service:this,action:"open"}};ot.navstate=i},t._close=function(){var t,e=((t={})[this.direction]=this._initialState,t[ft]=this.transition,t);s.css(this.nav,e),this.backdrop.hide(this.options.TRANSITION),this.alive=!1,this._closeClicked=!0;var i={alive:this.alive,activity:{service:this,action:"close"}};ot.navstate=i},t._cleanShadow=function(){s.css(this.nav,"boxShadow","none")},s}(),_t="class",wt=function(){function T(){this.backdrop=document.createElement("div"),this.backdrop.className="backdrop",w(this.backdrop,{background:"rgba(0,0,0,.4)",height:"100%",width:"100%",display:"none",position:"fixed",top:0,left:0}),this.body=document.body,this.Drawer=null,this.NavService=null,this.HashState=null}var t=T.prototype;return t.setup=function(t,e){if(!t)throw new TypeError("expected 'el' to be selector string or HTMLElement");var i=1..backdrop,s=1..HASH_NAV_MAX_WIDTH,n=1..NAV_DRAW_MAX_WIDTH,r=1..destinationId,o=1..destination,h=T.defaultConfig;if(e&&"object"==typeof e)for(var a=Object.keys(e),c=0;c<a.length;c++){var l=a[c];Object.prototype.hasOwnProperty.call(h,l)&&(h[l]=e[l])}var u=h.accessAttr,d=t instanceof HTMLElement?t:Y(t);r=E(d,u);var p=/^(?:#|\.|\u005b[^\u005c]\u005c)/.test(r),f=/^\./.test(r);o=Y(r=p?r:"#"+r);var v="cardinal-navcard-"+function(t){return Math.floor(Math.random()*t)}(256),g=f?r:function(t,e){return t.hasAttribute(e)}(o,_t)?k(o,_t):(function(t,e,i){t.setAttribute(e,i)}(o,_t,v),v),_=g.split(/\s+/);if(g="."+(2<=_.length?_[0]+"."+_[1]:g),o=f?o:Y(g),h.backdrop){var w=h.backdropClass||!1;w||o.insertAdjacentElement("beforeBegin",this.backdrop),"string"==typeof w&&(i=/^\./.test(w)?w:"."+w,this.backdrop=Y(i))}s=E(o,"data-hash-max-width"),n=E(o,"data-draw-max-width"),s=/px$/.test(s)?s:s+"px",n=/px$/.test(n)?n:n+"px";var m={ELEMENT:o,INIT_ELEM:d,BACKDROP:new rt(this.backdrop),BODY:this.body,TRANSITION:h.transition,DIRECTION:X[h.direction],unit:e.unit},b=y({},m,{MAX_WIDTH:n,DIRECTION:h.direction,maxStartArea:h.maxStartArea,threshold:h.threshold}),S=y({},m,{MAX_WIDTH:s});return new bt(Object.assign({},{defaultOptions:m},{drawerOptions:b},{hashOptions:S}))},t.toString=function(){return"[object NavCard]"},t._drawerAPI=function(t){var e=this;return this.Drawer=new pt(t),{activate:function(){return e.Drawer.activate()},deactivate:function(){return e.Drawer.deactivate()}}},t._hashAPI=function(t){var e=this;return this.HashState=new ht(this.NavService,t),{activate:function(){return e.HashState.activate()},deactivate:function(){return e.HashState.deactivate()}}},t._defaultAPI=function(t){var e=this;return this.NavService=new gt(t),{activate:function(){return e.NavService.activate()},deactivate:function(){return e.NavService.deactivate()}}},t.terminate=function(t){switch(t){case T.SERVICES.Default:this.NavService instanceof gt&&this.NavService.deactivate();break;case T.SERVICES.Drawer:this.Drawer instanceof pt&&this.Drawer.deactivate();break;case T.SERVICES.Hash:this.HashState instanceof ht&&this.HashState.deactivate();break;default:throw new Error("a service id is required")}},T}();t(wt,"defaultConfig",{transition:500,direction:"left",backdrop:!1,backdropClass:null,accessAttr:"data-target",maxStartArea:25,threshold:.5,unit:"px"}),t(wt,"SERVICES",{Default:2,Drawer:4,Hash:8});function mt(){}var bt=function(i){function t(t){var e;return(e=i.call(this)||this).options=t,e}r(t,i);var e=t.prototype;return e.mount=function(){this._defaultAPI(this.options.defaultOptions).activate(),this._drawerAPI(this.options.drawerOptions).activate(),this._hashAPI(this.options.hashOptions).activate()},e.unmount=function(){this.NavService.forceDeactivate(),this.Drawer.deactivate(),this.HashState.deactivate()},t}(wt);return t(mt,"CircularPath",e),t(mt,"Drawer",nt),t(mt,"Nav",wt),mt});