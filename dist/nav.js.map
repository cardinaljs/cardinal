{"version":3,"file":"nav.js","sources":["../src/util.js","../src/nav/backdrop.js","../src/nav/state.js","../src/nav/hashstate.js","../src/nav/drawer.js","../src/nav/navservice.js","../src/nav/index.js"],"sourcesContent":["// constants\nconst BLUR_SPREAD_SHADE = '0.7rem 0 rgba(0,0,0,.3)'\nexport const NAV_BOX_SHADOW = {\n  top: `0 0.2rem ${BLUR_SPREAD_SHADE}`,\n  left: `0.2rem 0 ${BLUR_SPREAD_SHADE}`,\n  bottom: `0 -0.2rem ${BLUR_SPREAD_SHADE}`,\n  right: `-0.2rem 0 ${BLUR_SPREAD_SHADE}`\n}\nexport const ZERO = 0\nexport const DIRECTIONS = [\n  'top', 'left',\n  'bottom', 'right'\n]\n\n// classes\nexport class Path {\n  constructor(x, y) {\n    this.x = x\n    this.y = y\n  }\n\n  /**\n   * Get difference between two paths\n   * @param {Path} path1 Path Object\n   * @param {Path} path2 Path Object\n   * @returns {Path} A different Path\n   */\n  static pathDifference(path1, path2) {\n    const x = path1.x - path2.x\n    const y = path1.y - path2.y\n    return new Path(x, y)\n  }\n\n  /**\n   * Join two different paths\n   * @param {Path} path1 Path Object\n   * @param {Path} path2 Path Object\n   * @returns {Path} A joined Path\n   */\n  static join(path1, path2) {\n    const x = path1.x + path2.x\n    const y = path1.y + path2.y\n    return new Path(x, y)\n  }\n}\n\nexport class Bound {\n  constructor(lower, upper) {\n    this.lower = lower\n    this.upper = upper\n  }\n\n  get gap() {\n    return this.upper - this.lower\n  }\n\n  get slack() {\n    return this.lower - this.upper\n  }\n}\n\n// functions\nexport function dataCamelCase(data) {\n  // remove 'data-' prefix and return camelCase string\n  return camelCase(data.substring(5), '-')\n}\n\nexport function camelCase(data, delim = '-') {\n  const list = data instanceof Array ? data : data.split(delim)\n  return list.reduce((acc, cur) => acc + cur.charAt(0)\n    .toUpperCase() + cur.slice(1)\n  )\n}\n\nexport function unique(max) {\n  return Math.floor(Math.random() * max)\n}\n\nexport function $(query) {\n  return document.querySelectorAll(query)[0]\n}\n\nexport function getAttribute(el, attr) {\n  return el.getAttribute(attr)\n}\n\nexport function hasAttribute(el, attr) {\n  return el.hasAttribute(attr)\n}\n\nexport function setAttribute(el, attr, value) {\n  el.setAttribute(attr, value)\n}\n\nexport function getData(el, attr) {\n  const prop = dataCamelCase(attr)\n  // this may return `undefined` in some Safari\n  if (el.dataset && el.dataset[prop]) {\n    return el.dataset[prop]\n  }\n  return getAttribute(el, attr)\n}\n\nexport function validateThreshold(tsh) {\n  const MAX_THRESHOLD = 1\n  const MIN_ILLEGAL_THRESHOLD = 0\n  if (tsh < MAX_THRESHOLD && tsh > MIN_ILLEGAL_THRESHOLD) {\n    tsh = MAX_THRESHOLD - tsh\n    return tsh\n  } else if (tsh < MIN_ILLEGAL_THRESHOLD) {\n    tsh = MAX_THRESHOLD\n    return tsh\n  }\n  return MAX_THRESHOLD\n}\n\n/**\n * @param {HTMLElement} el an HTMLElement whose style should\n * be accessed\n * @param {string | string[] | {}} property A property/properties\n * to set or get\n * @param {string | number} value value to set as\n * @returns {CSSStyleDeclaration | string} A css style property\n * or CSSStyleDeclaration object\n */\nexport function css(...args) {\n  if (args.length < 1) {\n    return null\n  }\n  const el = args[0]\n  const property = args[1]\n  let value = args[2]\n  const STYLEMAP = window.getComputedStyle(el)\n\n  if (typeof property === 'string' && value) {\n    // setting one property\n    el.style[property] = value\n    return null\n  }\n  if (typeof property === 'object' && property instanceof Object) {\n    // `style` MUST = null\n    // setting many properties\n    value = property\n    for (const prop of Object.keys(value)) {\n      el.style[prop] = value[prop]\n    }\n  } else if (property instanceof Array) {\n    // return all values of properties in the array for\n    // the element as object\n    const ostyle = {}\n    for (const prop of STYLEMAP) {\n      ostyle[prop] = STYLEMAP[prop]\n    }\n    return ostyle\n  } else {\n    // get style from property\n    return STYLEMAP[property]\n  }\n  return STYLEMAP\n}\n","import {\n  css\n} from '../util'\n\nexport class Backdrop {\n  constructor(backdrop) {\n    this.backdrop = backdrop\n  }\n\n  show(time) {\n    css(this.backdrop, {\n      display: 'block',\n      opacity: 1,\n      transition: `opacity linear ${time / 1e3}s`\n    })\n  }\n\n  hide(time) {\n    css(this.backdrop, {\n      opacity: 0,\n      transition: `opacity linear ${time / 1e3}s`\n    })\n    window.setTimeout(() => {\n      css(this.backdrop, {\n        display: 'none'\n      })\n    }, time)\n  }\n\n  setOpacity(val) {\n    css(this.backdrop, {\n      display: 'block',\n      opacity: val,\n      transition: 'none'\n    })\n  }\n}\n","export default {\n  navstate: null\n}\n","import STATE from './state'\nimport {\n  getAttribute\n} from './../util'\n\nclass HashState {\n  constructor(parentService, options) {\n    this.options = options\n    this.parentService = parentService\n    this.button = options.INIT_ELEM\n    this.event = 'hashchange'\n    this.handler = null\n  }\n\n  activate() {\n    const handler = (e) => {\n      this._hashchange(e)\n    }\n    this._register(handler)\n    window.addEventListener(this.event, this.handler)\n    return 0\n  }\n\n  deactivate() {\n    window.removeEventListener(this.event, this.handler)\n    this._register(null)\n    return 0\n  }\n\n  _hashchange(e) {\n    const oldHash = HashState._getHash(e.oldURL)\n    if (oldHash === getAttribute(this.button, 'href') && STATE.navstate && STATE.navstate.alive) {\n      this.parentService._close()\n    }\n  }\n\n  _register(handler) {\n    this.handler = handler\n  }\n\n  static _getHash(uri) {\n    let hash = uri\n    const indexOfHash = hash.lastIndexOf('#')\n    hash = indexOfHash !== -1 ? hash.slice(indexOfHash).replace(/(?:[^\\w\\d-]+)$/) : null\n    return hash\n  }\n}\n\nexport default HashState\n","import {\n  Bound,\n  DIRECTIONS,\n  NAV_BOX_SHADOW,\n  css,\n  getAttribute,\n  getData\n} from './../util'\nimport Drawer from './../drawer/'\nimport STATE from './state'\n\nconst ZERO = 0\nconst KILO = 1e3\nconst MIN_TIME_TO_OVERRIDE_BELOWTHRESHOLD = 0.5\nconst MIN_POSITIVE_DISPLACEMENT = 10\nconst MIN_NEGATIVE_DISPLACEMENT = -MIN_POSITIVE_DISPLACEMENT\nconst TRANSITION_STYLE = 'linear'\nconst EFFECT = 'transition'\nconst OVERFLOW = 'overflow'\nconst TRANS_TIMING = '0.1s'\nconst TRANS_TEMPLATE = `${TRANSITION_STYLE} ${TRANS_TIMING}`\nconst HIDDEN = 'hidden'\nconst SCROLL = 'scroll'\nconst HREF = 'href'\nconst HASH_ATTR = `data-${HREF}`\nconst START = 'start'\nconst MOVE = 'move'\nconst THRESHOLD = 'threshold'\nconst BELOW_THRESHOLD = `below${THRESHOLD}`\nconst MAX_TIME = KILO\nconst MAX_SPEED = 500\n\nclass NavDrawer {\n  /**\n   * Creates a new NavDrawer object. Providing the Left and Right\n   * Drawer functionality.\n   * Support for Top and Bottom may come in the future\n   * @throws RangeError\n   * @param {{}} options An options Object to configure the Drawer with\n   */\n  constructor(options) {\n    this.options = options\n    this.element = this.options.ELEMENT\n    this._body = this.options.BODY\n    this._backdrop = this.options.BACKDROP\n    this.direction = this.options.DIRECTION\n\n    this._checkDirection()\n\n    this.directionString = DIRECTIONS[this.direction]\n    this.bound = this._bound\n\n    const o = {\n      ...options,\n      SIZE: this.elementSize,\n      TARGET: document\n    }\n    this.drawer = new Drawer.SnappedDrawer(o, this.bound)\n    this.transition = `${this.directionString} ${TRANS_TEMPLATE}`\n  }\n\n  activate() {\n    this.drawer.on(START, this._startHandler)\n      .on(MOVE, this._moveHandler)\n      .on(THRESHOLD, this._threshold)\n      .on(BELOW_THRESHOLD, this._belowThreshold)\n      .setContext(this)\n      .activate()\n    return 0\n  }\n\n  deactivate() {\n    this.drawer.deactivate()\n    return 0\n  }\n\n  get elementSize() {\n    const axis = this.direction\n    if (axis === Drawer.UP || axis === Drawer.DOWN) {\n      return this.element.offsetHeight\n    }\n    return this.element.offsetWidth\n  }\n\n  /**\n   * @returns {Bound} a boundary object: Bound\n   */\n  get _bound() {\n    const curPos = css(this.element, this.directionString)\n      .replace(/[^\\d]*$/, '')\n    const upperBound = this.elementSize\n    const lowerBound = upperBound + parseInt(curPos, 10)\n    return new Bound(lowerBound, upperBound)\n  }\n\n  _startHandler(response) {\n    css(this.element, {\n      [this.directionString]: response.dimension,\n      boxShadow: NAV_BOX_SHADOW[this.directionString],\n      [EFFECT]: this.transition\n    })\n    this._body.style.overflow = HIDDEN\n  }\n\n  _moveHandler(response, rectangle) {\n    let curPos = this.direction === Drawer.UP || this.direction === Drawer.DOWN ? rectangle.coordsY.y2 : rectangle.coordsX.x2\n    css(this.element, {\n      [this.directionString]: response.dimension,\n      [EFFECT]: 'none',\n      [OVERFLOW]: HIDDEN\n    })\n    if (this.direction === Drawer.RIGHT) {\n      const WIN_SIZE = window.screen.availWidth\n      curPos = WIN_SIZE - curPos\n      this._backdrop.setOpacity(curPos / this.elementSize)\n      return\n    }\n    this._backdrop.setOpacity(curPos / this.elementSize)\n  }\n\n  _threshold(state, stateObj) {\n    const isOpen = state[1] === 'open'\n    const options = {\n      stateObj,\n      transition: `${this.directionString} ease ${this._calcSpeed(stateObj.TIMING) / KILO}s`\n    }\n    if (isOpen) {\n      this._hide(options)\n    } else {\n      this._show(options)\n    }\n  }\n\n  _belowThreshold(state, stateObj, rect) {\n    const isClosed = state[1] !== 'open'\n    const overallEventTime = stateObj.TIMING\n    const MTTOB = MIN_TIME_TO_OVERRIDE_BELOWTHRESHOLD\n    const MPD = MIN_POSITIVE_DISPLACEMENT\n    const MND = MIN_NEGATIVE_DISPLACEMENT\n    const displacement = this.direction === Drawer.UP || this.direction === Drawer.DOWN\n      ? rect.displacementY : rect.displacementX\n    const options = {\n      stateObj,\n      transition: `${this.directionString} ease ${this._calcSpeed(stateObj.TIMING) / KILO}s`\n    }\n    let LOGIC\n    if (this.direction === Drawer.LEFT && isClosed || this.direction === Drawer.RIGHT && !isClosed) {\n      LOGIC =  displacement > ZERO && displacement >= MPD && rect.greaterWidth\n    } else {\n      LOGIC = displacement < ZERO && displacement <= MND && rect.greaterWidth\n    }\n\n    if (overallEventTime / KILO < MTTOB) {\n      // DIRECTION: Drawer.UP | Drawer.LEFT\n      if (LOGIC) {\n        this._overrideBelowThresh(!isClosed, options)\n      } else {\n        if (isClosed) {\n          // close it back didn't hit thresh. and can't override\n          this._hide(options)\n          return\n        }\n        // open it back didn't hit thresh. and can't override because not enough displacement\n        this._show(options)\n      }\n    } else {\n      if (isClosed) {\n        // close it back didn't hit thresh. and can't override because not enough velocity or displacement\n        this._hide(options)\n        return\n      }\n      // open it back didn't hit thresh. and can't override because not enough velocity or displacement\n      this._show(options)\n    }\n  }\n\n  _show(options) {\n    this._showPrep(options)\n    this.element.style[this.directionString] = options.stateObj.dimension\n  }\n\n  _hide(options) {\n    this._hidePrep(options)\n    this.element.style[this.directionString] = options.stateObj.dimension\n  }\n\n  _overrideBelowThresh(isOpen, options) {\n    if (isOpen) {\n      this._hidePrep(options)\n      this.element.style[this.directionString] = options.stateObj.oppositeDimension\n    } else {\n      this._showPrep(options)\n      this.element.style[this.directionString] = options.stateObj.oppositeDimension\n    }\n  }\n\n  _hidePrep(options) {\n    this._body.style.overflow = SCROLL\n    this._backdrop.hide(this.options.TRANSITION)\n    css(this.element, {\n      [EFFECT]: options.transition,\n      [OVERFLOW]: SCROLL\n    })\n    if (!this.bound.lower) {\n      this.element.style.boxShadow = 'none'\n    }\n    this._setState('open')\n  }\n\n  _showPrep(options) {\n    window.location.hash = getAttribute(this.options.INIT_ELEM, HREF) || getData(this.options.INIT_ELEM, HASH_ATTR)\n    this._body.style.overflow = HIDDEN\n    this._backdrop.show(this.options.TRANSITION)\n    css(this.element, {\n      [EFFECT]: options.transition,\n      [OVERFLOW]: SCROLL\n    })\n    this._setState('open')\n  }\n\n  _calcSpeed(time) {\n    if (time >= MAX_TIME) {\n      return MAX_SPEED\n    }\n    const percent = 100\n    const percentage = time / MAX_TIME * percent\n    return percentage / percent * MAX_SPEED\n  }\n\n  _checkDirection() {\n    if (this.direction !== Drawer.LEFT && this.direction !== Drawer.RIGHT) {\n      throw RangeError('Direction out of range')\n    }\n  }\n\n  _setState(mode) {\n    switch (mode) {\n      case 'open':\n        STATE.navstate = {\n          alive: true,\n          activity: {\n            service: this,\n            action: mode\n          }\n        }\n        break\n      case 'close':\n        STATE.navstate = {\n          alive: false,\n          activity: {\n            service: this,\n            action: mode\n          }\n        }\n        break\n      default:\n        throw new Error('this should never happen')\n    }\n  }\n}\n\nexport default NavDrawer\n","import {\n  NAV_BOX_SHADOW,\n  ZERO,\n  css,\n  getAttribute\n} from './../util'\nimport STATE from './state'\n\nconst TRANSITION_STYLE = 'ease'\nconst EFFECT = 'transition'\nconst TRANS_END = 'transitionend'\n\nclass NavService {\n  constructor(options) {\n    this.options = options\n    this.nav = options.ELEMENT\n    this.button = options.INIT_ELEM\n    this.backdrop = options.BACKDROP\n    this.backdropElement = this.backdrop.backdrop\n    this.event = 'click'\n    this.direction = options.DIRECTION\n    this.width = this.nav.offsetWidth\n    this.transTime = options.TRANSITION / 1e3\n    this.transition = `${this.direction} ${TRANSITION_STYLE} ${this.transTime}s`\n    // state of the nav, whether open or close\n    this.alive = false\n    // diff. btw. event triggered from Drawer class and on here\n    /**\n     * @private\n     */\n    this._closeClicked = false\n    /**\n     * @readonly\n     * @private\n     */\n    this._initialState = NavService.css(this.nav, this.direction)\n    this._handlers = null\n  }\n\n  activate() {\n    const ClickHandler = (e) => {\n      this.handler(e)\n    }\n    const BackdropHandler = () => {\n      this._close()\n    }\n    const TransitionHandler = () => {\n      if (!this.alive && this._closeClicked) {\n        this._cleanShadow()\n        this._closeClicked = false\n      }\n    }\n    this._register({\n      ClickHandler,\n      BackdropHandler,\n      TransitionHandler\n    })\n\n    this.button.addEventListener(this.event, this._handlers.ClickHandler)\n    this.backdropElement.addEventListener(this.event, this._handlers.BackdropHandler)\n    if (this._initialState === `-${this._width('px')}`) {\n      this.nav.addEventListener(TRANS_END, this._handlers.TransitionHandler)\n    }\n    return 0\n  }\n\n  deactivate() {\n    throw new ReferenceError('cannot deactivate API specified as default. This service must be kept running')\n  }\n\n  forceDeactivate() {\n    this.button.removeEventListener(this.event, this._handlers.ClickHandler)\n    this.backdropElement.removeEventListener(this.event, this._handlers.BackdropHandler)\n    if (this._initialState === `-${this._width('px')}`) {\n      this.nav.removeEventListener(TRANS_END, this._handlers.TransitionHandler)\n    }\n    this._register(null)\n  }\n\n  handler(e) {\n    e.preventDefault()\n    window.location.hash = getAttribute(this.button, 'href')\n    const state = NavService._toNum(NavService.css(this.nav, this.direction))\n    if (state < ZERO) {\n      this._open()\n    } else {\n      this._close()\n    }\n  }\n\n  static css(el, property, style) {\n    return css(el, property, style)\n  }\n\n  static _toNum(val) {\n    val = val.replace(/[^\\d]*$/, '')\n    return /\\.(?=\\d)/.test(val) ? Math.round(parseFloat(val)) : parseInt(val, 10)\n  }\n\n  _width(unit) {\n    unit = unit || ''\n    return this.width + unit\n  }\n\n  _register(handler) {\n    this._handlers = handler\n  }\n\n  _open() {\n    const style = {\n      [this.direction]: ZERO,\n      [EFFECT]: this.transition,\n      boxShadow: NAV_BOX_SHADOW[this.direction]\n    }\n    NavService.css(this.nav, style)\n    this.backdrop.show(this.options.TRANSITION)\n    this.alive = true\n    const state = {\n      alive: this.alive,\n      activity: {\n        service: this,\n        action: 'open'\n      }\n    }\n    STATE.navstate = state\n  }\n\n  _close() {\n    const style = {\n      [this.direction]: this._initialState,\n      [EFFECT]: this.transition\n      // don't clean shadow here\n      // it's transitioning\n    }\n    NavService.css(this.nav, style)\n    this.backdrop.hide(this.options.TRANSITION)\n    this.alive = false\n    this._closeClicked = true\n    const state = {\n      alive: this.alive,\n      activity: {\n        service: this,\n        action: 'close'\n      }\n    }\n    STATE.navstate = state\n  }\n\n  _cleanShadow() {\n    NavService.css(this.nav, 'boxShadow', 'none')\n  }\n}\n\nexport default NavService\n","import {\n  $,\n  DIRECTIONS,\n  css,\n  getAttribute,\n  getData,\n  hasAttribute,\n  setAttribute,\n  unique\n} from './../util'\nimport {\n  Backdrop\n} from './backdrop'\nimport HashState from './hashstate'\nimport NavDrawer from './drawer'\nimport NavService from './navservice'\n\nconst BACKDROP = 'backdrop'\nconst DEF_CLASSNAME = 'cardinal-navcard'\nconst MEDIA_HASH = 'data-hash-max-width'\nconst MEDIA_DRAW = 'data-draw-max-width'\nconst _CLASS = 'class'\n\nclass NavCard {\n  constructor() {\n    /**\n     * Covert Backdrop\n     * ----------------\n     * Just incase `options.backdrop = false`\n     * prevents multiple `if` statements\n     * so we don't have to check whether\n     * backdrop is enabled anytime we want to access it.\n     *\n     * Insert into DOM only:\n     * when `options.backdrop = true`\n     * `options.backdropClass` is undefined\n     */\n    this.backdrop = document.createElement('div')\n    this.backdrop.className = BACKDROP\n    css(this.backdrop, {\n      background: 'rgba(0,0,0,.4)',\n      height: '100%',\n      width: '100%',\n      display: 'none',\n      position: 'fixed',\n      top: 0,\n      left: 0\n    })\n\n    this.body = document.body\n    this.Drawer = null\n    this.NavService = null\n    this.HashState = null\n  }\n\n  static defaultConfig = {\n    transition: 500,\n    direction: 'left',\n    backdrop: false,\n    backdropClass: null,\n    accessAttr: 'data-target',\n    maxStartArea: 25,\n    threshold: 1 / 2,\n    unit: 'px'\n  }\n\n  static SERVICES = {\n    Default: 2,\n    Drawer: 4,\n    Hash: 8\n  }\n\n  setup(el, options) {\n    if (!el) {\n      throw new TypeError('expected \\'el\\' to be selector string or HTMLElement')\n    }\n    let {\n      backdrop,\n      HASH_NAV_MAX_WIDTH,\n      NAV_DRAW_MAX_WIDTH,\n      destinationId,\n      destination\n    } = 1\n    const opts = NavCard.defaultConfig\n\n    if (options && typeof options === 'object') {\n      for (const prop of Object.keys(options)) {\n        if (Object.prototype.hasOwnProperty.call(opts, prop)) {\n          opts[prop] = options[prop]\n        } else {\n          continue\n        }\n      }\n    }\n\n    const dataAccess = opts.accessAttr\n\n    /**\n     * Initialization element e.g <button ...</button>\n     */\n    const element = el instanceof HTMLElement ? el : $(el)\n    destinationId = getData(element, dataAccess)\n\n    // check if the data-* attribute value is a valid css selector\n    // if not prepend a '#' to it as id selector is default\n    const isCSSSelector = /^(?:#|\\.|\\u005b[^\\u005c]\\u005c)/.test(destinationId)\n    const isClass = /^\\./.test(destinationId)\n    destinationId = isCSSSelector ? destinationId : `#${destinationId}`\n\n    destination = $(destinationId)\n\n    // we want a class too, so in case we've got an id selector\n    // find the classname or assign a unique class\n    const defaultClass = `${DEF_CLASSNAME}-${unique(2 << 7)}`\n    // eslint-disable-next-line no-nested-ternary\n    let classname = isClass ? destinationId : hasAttribute(destination, _CLASS)\n      ? getAttribute(destination, _CLASS) : (setAttribute(destination, _CLASS, defaultClass), defaultClass)\n    const classlist = classname.split(/\\s+/)\n    // eslint-disable-next-line prefer-template\n    classname = '.' + (classlist.length >= 2 ? classlist[0] + '.' + classlist[1] : classname)\n    destination = isClass ? destination : $(classname)\n\n    if (opts.backdrop) {\n      const backdropclass = opts.backdropClass || false\n      // if `opts.backdrop` and no `backdropclass` given\n      // append our custom backdrop\n      if (!backdropclass) {\n        destination.insertAdjacentElement('beforeBegin', this.backdrop)\n      }\n\n      if (typeof backdropclass === 'string') {\n        // check if backdropclass is normal string or css class selector\n        backdrop =  /^\\./.test(backdropclass) ? backdropclass : `.${backdropclass}`\n        this.backdrop = $(backdrop)\n      }\n    }\n\n    HASH_NAV_MAX_WIDTH = getData(destination, MEDIA_HASH)\n    NAV_DRAW_MAX_WIDTH = getData(destination, MEDIA_DRAW)\n    HASH_NAV_MAX_WIDTH = /px$/.test(HASH_NAV_MAX_WIDTH) ? HASH_NAV_MAX_WIDTH : `${HASH_NAV_MAX_WIDTH}px`\n    NAV_DRAW_MAX_WIDTH = /px$/.test(NAV_DRAW_MAX_WIDTH) ? NAV_DRAW_MAX_WIDTH : `${NAV_DRAW_MAX_WIDTH}px`\n\n    const defaultOptions = {\n      ELEMENT: destination,\n      INIT_ELEM: element,\n      BACKDROP: new Backdrop(this.backdrop),\n      BODY: this.body,\n      TRANSITION: opts.transition,\n      DIRECTION: DIRECTIONS[opts.direction],\n      unit: options.unit\n    }\n    const drawerOptions = {\n      ...defaultOptions,\n      MAX_WIDTH: NAV_DRAW_MAX_WIDTH,\n      DIRECTION: opts.direction,\n      maxStartArea: opts.maxStartArea,\n      threshold: opts.threshold\n    }\n    const hashOptions = {\n      ...defaultOptions,\n      MAX_WIDTH: HASH_NAV_MAX_WIDTH\n    }\n\n    return new NavMountWorker(Object.assign({}, {\n      defaultOptions\n    }, {\n      drawerOptions\n    }, {\n      hashOptions\n    }))\n  }\n\n  toString() {\n    return '[object NavCard]'\n  }\n\n  _drawerAPI(options) {\n    this.Drawer = new NavDrawer(options)\n    return {\n      activate: () => this.Drawer.activate(),\n      deactivate: () => this.Drawer.deactivate()\n    }\n  }\n\n  _hashAPI(options) {\n    this.HashState = new HashState(this.NavService, options)\n    return {\n      activate: () => this.HashState.activate(),\n      deactivate: () => this.HashState.deactivate()\n    }\n  }\n\n  _defaultAPI(options) {\n    this.NavService = new NavService(options)\n    return {\n      activate: () => this.NavService.activate(),\n      deactivate: () => this.NavService.deactivate()\n    }\n  }\n\n  terminate(service) {\n    // this._*API(null).deactivate()\n    switch (service) {\n      case NavCard.SERVICES.Default:\n        if (this.NavService instanceof NavService) {\n          this.NavService.deactivate()\n        }\n        break\n      case NavCard.SERVICES.Drawer:\n        if (this.Drawer instanceof NavDrawer) {\n          this.Drawer.deactivate()\n        }\n        break\n      case NavCard.SERVICES.Hash:\n        if (this.HashState instanceof HashState) {\n          this.HashState.deactivate()\n        }\n        break\n      default:\n        throw new Error('a service id is required')\n    }\n  }\n}\n\nclass NavMountWorker extends NavCard {\n  constructor(options) {\n    super()\n    this.options = options\n  }\n\n  mount() {\n    this._defaultAPI(this.options.defaultOptions).activate()\n    this._drawerAPI(this.options.drawerOptions).activate()\n    this._hashAPI(this.options.hashOptions).activate()\n  }\n\n  unmount() {\n    this.NavService.forceDeactivate()\n    this.Drawer.deactivate()\n    this.HashState.deactivate()\n  }\n}\n\nexport default NavCard\n"],"names":["BLUR_SPREAD_SHADE","NAV_BOX_SHADOW","top","left","bottom","right","ZERO","DIRECTIONS","Bound","lower","upper","dataCamelCase","data","camelCase","substring","delim","list","Array","split","reduce","acc","cur","charAt","toUpperCase","slice","unique","max","Math","floor","random","$","query","document","querySelectorAll","getAttribute","el","attr","hasAttribute","setAttribute","value","getData","prop","dataset","css","length","property","STYLEMAP","window","getComputedStyle","style","Object","keys","ostyle","Backdrop","backdrop","show","time","display","opacity","transition","hide","setTimeout","setOpacity","val","navstate","HashState","parentService","options","button","INIT_ELEM","event","handler","activate","e","_hashchange","_register","addEventListener","deactivate","removeEventListener","oldHash","_getHash","oldURL","STATE","alive","_close","uri","hash","indexOfHash","lastIndexOf","replace","KILO","MIN_TIME_TO_OVERRIDE_BELOWTHRESHOLD","MIN_POSITIVE_DISPLACEMENT","MIN_NEGATIVE_DISPLACEMENT","TRANSITION_STYLE","EFFECT","OVERFLOW","TRANS_TIMING","TRANS_TEMPLATE","HIDDEN","SCROLL","HREF","HASH_ATTR","START","MOVE","THRESHOLD","BELOW_THRESHOLD","MAX_TIME","MAX_SPEED","NavDrawer","element","ELEMENT","_body","BODY","_backdrop","BACKDROP","direction","DIRECTION","_checkDirection","directionString","bound","_bound","o","SIZE","elementSize","TARGET","drawer","Drawer","SnappedDrawer","on","_startHandler","_moveHandler","_threshold","_belowThreshold","setContext","response","dimension","boxShadow","overflow","rectangle","curPos","UP","DOWN","coordsY","y2","coordsX","x2","RIGHT","WIN_SIZE","screen","availWidth","state","stateObj","isOpen","_calcSpeed","TIMING","_hide","_show","rect","isClosed","overallEventTime","MTTOB","MPD","MND","displacement","displacementY","displacementX","LOGIC","LEFT","greaterWidth","_overrideBelowThresh","_showPrep","_hidePrep","oppositeDimension","TRANSITION","_setState","location","percent","percentage","RangeError","mode","activity","service","action","Error","axis","offsetHeight","offsetWidth","upperBound","lowerBound","parseInt","TRANS_END","NavService","nav","backdropElement","width","transTime","_closeClicked","_initialState","_handlers","ClickHandler","BackdropHandler","TransitionHandler","_cleanShadow","_width","ReferenceError","forceDeactivate","preventDefault","_toNum","_open","test","round","parseFloat","unit","DEF_CLASSNAME","MEDIA_HASH","MEDIA_DRAW","_CLASS","NavCard","createElement","className","background","height","position","body","setup","TypeError","HASH_NAV_MAX_WIDTH","NAV_DRAW_MAX_WIDTH","destinationId","destination","opts","defaultConfig","prototype","hasOwnProperty","call","dataAccess","accessAttr","HTMLElement","isCSSSelector","isClass","defaultClass","classname","classlist","backdropclass","backdropClass","insertAdjacentElement","defaultOptions","drawerOptions","MAX_WIDTH","maxStartArea","threshold","hashOptions","NavMountWorker","assign","toString","_drawerAPI","_hashAPI","_defaultAPI","terminate","SERVICES","Default","Hash","mount","unmount"],"mappings":"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"}